\section{} % 09
Всё для связного графа $G$.
Вводим пр-во циклов.
Рассмотрим мн-во подмножеств рёбер как линейное пр-во $\mathcal E = (\mathbb F_2)^m$
(плюс "--- симметрическая разность), можно ввести произведение подмножеств
(скалярно, это чётность размера пересечения).
Декомпозиция: разбили на попарно непересекающиеся по рёбрам подграфы на $V$
(можно декомпозировать на циклы/пути).
Veblen: есть декомпозиция на циклы $\iff$ граф чётен (все вершины чётной степени),
$\Ra$ очевидно, $\La$ индукция по числу рёбер.
Симметрическая разность чётных подграфов чётна
Множество чётных подграфов образует линейное подпр-во $C$ в $\mathcal E$,
оно порождается всеми циклами, называется пр-вом циклов.
Взяли остовное дерево $T$ (остаток рёбер "--- хорды, образуют кодерево).
Взяли хорду $e$, получили фундаментальный цикл, цикловый ранг $\gamma(G)$ "---
кол-во фундаментальных ($m-n+1$).
Фундаментальные линейно независимы (так как хорда лежит ровно в одном фундаментальном).

Вводим пр-во разрезов (окажется ортогонально $C$ и в нём найдётся $n-1$ линейно независимый вектор,
отсюда сразу будет следовать базисность всего на свете).
Подмножество $F\subseteq E$ рёберно разделяющее, если граф $G-F$ несвязен.
Рёберный разрез $[S_1, S_2]$ (тут $S_1, S_2 \subseteq V$) "--- ребра с одним концом
в $S_1$, с другим $S_2$, дальше интересуемся только $S_2=V\setminus S_1$.
Кограница мн-ва вершин $S$: $\delta(S)=[S,V\setminus S]$.
Очевидно $\delta(S)=\delta(\bar S)$, $\delta(S)=E \iff$ граф двудолен.
Тривиальный разрез: $\delta(\{x\})$ (размера $\deg x$).
Аналогично назовём $|\delta(S)|$ степенью $S$ (в случае мультиграфа без петель).
Любая кограница есть рёберно разделяющее (обратное неверно, см. треугольник с ручкой).
Минимальный рёберный разрез "--- рёберный разрез, любое строгое подмн-во рёберным разрезом не является.
Разрез $\delta(S)$ минимален $\iff$ граф $G - \delta(S)$ имеет ровно две компоненты связности.
$\La$: взяли две компоненты, взяли собственный рёберный разрез, упс, соединились.
$\Ra$: иначе либо в $S$, либо в $\bar S$ есть две компоненты, тогда можно взять одну из них,
получим собственный рёберный разрез.
Симметрическая разность разных разрезов есть разрез: нарисовали картинки.
Тогда все разрезы образуют линейное пространство рёберных разрезов $B$.
Теперь берём дерево $T$, удаление ребра $e$ бьёт вершины на $S$ и $\bar S$,
тогда фундаментальный разрез (связанный с деревом $T$) "--- $\delta(S)$,
все фундаментальные линейно независимы.

\TODO тут была ботва с тем, что скалярное произведение странное, надо смотреть в билет 12?
Нельзя пилить пространство на $V$ и $V^\bot$, если произведение не положительноопределённое.

Доказываем $C=B^\bot$.
Взяли цикл и разрез, они пересеклись по чётному числу рёбер (зашли в $S$, вышли из $S$),
$C\subseteq B^\bot$.
Теперь возьмём $F\notin C$, пересекающийся с циклом по чётному числу рёбер.
Тогда есть вершина $x$, инцидентная нечётному числу рёбер из $F$ (иначе $F$ чётен).
Догда тривиальный разрез $\delta(\{x\})$ и $F$ пересекаются по нечётному числу рёбер,
т.е. $F$ не лежит в $B^\bot$, тогда $C=B^\bot$.
Осталось показать $B=(B^\bot)^\bot$.
Любой разрез ортогонален циклу, т.е. $B\subseteq C^\bot = (B^\bot)^\bot$,
дальше считаем размерности, $\dim B = \dim (B^\bot)^\bot$.
Следствие: мы в $B$ и $C$ знаем размерности и базисы (так как знаем нужные линейно независимые,
а сумма размерностей ровно $m$).

\section{} % 10
Гамильтонов цикл "--- надо пройти все вершины.
Критериев необходимости/достаточности еще нет, искать сложно.
Необходимость: число компонент связности в $G-S$ не больше $|S|$.
Если есть гамильтонов путь, то можно достроить до цикла, если $\deg x_1 + \deg x_n \ge n$
(нашли $x_i \to x_n$, $x_1 \to x_{i+1}$, развернули).
Следствие: есть максимальный по включению путь длины $k$, тогда его можно превратить в цикл,
если сумма степеней $\ge k$ (не забыть про случай смежности вершин).
Теорема Оре: если $n>2$ и для любых двух $\deg x + \deg y \ge n - 1$, то есть гам. путь.
Док-во: любые две вершины либо связны, либо имеют общего соседа.
Пусть нет гамильтонова пути, тогда есть цикл длины $k<n$, тогда по связности
есть вершина, смежная с вершиной цикла и в него не входящая, противоречие.
Следствие: если для всех $\deg x + \deg y \ge n$, то есть гам. цикл.
Следствие (Дирак): если степень каждой $\ge \frac{n-1}{2}$, то есть путь, если
$\ge \frac{n}{2}$, то есть цикл.

Пусть $G$ "--- простой граф, есть пара несмежных $x$, $y$, причём
$\deg x + \deg y \ge n$.
Тогда в $G$ есть гам. цикл $\iff$ в $G+\{x, y\}$ есть гам. цикл.
В одну сторону понятно, в другую сторону: был цикл, выкинули ребро,
остался путь, преобразовали в цикл.
Замыкание $C(G)$ "--- добавляем такие рёбра, пока можем (степени при этом меняются).
Порядок неважен: пусть добавляли в порядке $e_1, \dots, e_r$ и $f_1, \dots, f_s$ (во втором получили граф $H$),
предположим, что $e_i$ во втором списке нет ($i$ минимально).
Тогда в $G_1=G+\{e_1, \dots, e_{i-1}\}$ верно $\deg_{G_1} x + \deg_{G_1} y \ge n$,
при этом $G_1 \le H$, но $e_i \notin H$, значит, $e_i$ можно добавить в $H$.
Бонди-Хватала: простой граф имеет гамильтонов цикл $\iff$ $C(G)$ имеет гамильтонов цикл.
Следствие: если $C(G)=K_n$, то ок.
Дирак "--- частный случай, т.к. замыкается всё до $K_n$.

Хватала: пусть в простом $G$ степенная последовательность $(d_1, \dots, d_n)$ имеет для $i<n/2$:
$d_i>i\lor d_{n-i}\ge(n-i)$.
Тогда есть гам. цикл.
Док-во: замкнули, не получили полный, взяли пару $(x, y)$ с максимальной $s=\deg x + \deg y < n$.
Пусть $k=\deg x \le \deg y$, тогда $k < \frac{n}{2}$ и $\deg y < n-k$.
Более того, так как $s$ максимально, то все несмежные с $y$ имеют степень не больше $k$,
их $n-1-\deg y$, т.е. (из $s \le n-1$) их хотя бы $\deg x = k$.
Любая несмежная с $x$ имеет степень не больше $\deg y < n-k$,
их $n-1-k$.
Сама $x$ тоже имеет степень $< n-k$, т.е. всего таких вершин $n-k$.
Нашли в замыкании $k$ вершин степени не больше $k$, $n-k$ вершин степени $<n-k$,
т.е. в исходном они тоже были, противоречие (\TODO да ладно?)

\section{} % 11
Обобщение Дирака: сильносвязный орграф, входящие/исходящие степени каждой $\ge \frac{n}{2}$,
без доказательства.
Турнир "--- полный орграф.
В любом есть гамильтонов путь.
Индукция по числу вершин, удаляем вершину, берём старый путь, вклиниваем вершину в середину.

Циклическая строка длины $k$ над алфавитом из $n$ символов, содержащая все
$k$-меры (их $n^k$) имеет длину не менее $n^k$.
Можно искать гамильтонов цикл в графе над $n^k$ вершинами,
а можно построить граф де Брёйна: $n^{k-1}$ вершин, ребро $x \to y$,
если к $x$ дописали символ, откусили начало, получили $y$.
Рёбер $n^k$, надо найти Эйлеров цикл.
Он всегда есть.
Всего циклов де Брёйна $(n!)^{n^{k-1}}/n^k$, без доказательства.

\section{} % 12
Взвешенный орграф "--- $(D, f)$, функция из рёбер в поле (обычно в $\R$), это вес ребра.
Будем считать $f$ вектором размерности $|E(D)|$.
$f$ циркуляция, если в вершину входит и выходит одинаково, $M_i \cdot f = 0$,
образовалось пр-во циркуляций (пр-во, ортогональное строкам $M_i$).
Рассмотрим underylying graph (стёрли ориентацию), как-то обошли в нём цикл,
построили циркуляцию в исходном (поток может быть $\pm 1$) "--- связанная с циклом.
Носитель циркуляции "--- рёбра, где не ноль.
Носитель ненулевой содержит цикл (так как степень любой вершины хотя бы два $\Ra$ не лес).
Теперь любая циркуляцию распадается на связанные с циклами: индукция по размеру носителя.
Взяли цикл, занулили какое-то ребро.

Теперь смотрим на остовное дерево $T$, тогда можно найти фундаментальные циклы,
к ним "--- циркуляции (причём полагая $f_e(e)=1$), тогда вектора $f_e$ линейно независимы.
Образуют пространство $C$.
Рассмотрим пр-во $B$ строк матрицы $M_i$.
Пусть есть $g=pM_i$, тогда $p$ "--- потенциалы вершин, $B$ "--- пр-во напряжений.
Любой минимальный рёберный разрез $\delta X$ порождает напряжение: единица в $X$, ноль снаружи.
Всё $B$ порождается минимальными рёберными: берём носитель напряжения $g$,
берём произвольное ребро $x\to y$, берём мн-во вершин с потенциалом $p(x)$, получили нетривиальный
рёберный разрез, его можно занулить, т.е. можно взять в нём минимальный и занулить его, успех.
Аналогично берём фундаментальные разрезы, они линейно независимы.

Напряжения и циркуляции ортогональны (выписали формулы).
При этом пересечение состоит из единственного нуля.
Размерности пр-в хотя бы $n-1$ и $m-n+1$, при этом $C=B^\bot$, сумма размерностей не может быть больше $m$, успех.
Напоминание: прямоугольная матрица унимодулярна, если определитель любой максимальной квадратной подматрицы равен $\{0,\pm1\}$
и вполне унимодулярна, если это верно для любой квадратной подматрицы.
Теорема Пуанкаре: $M_i$ вполне унимодулярна.
Взяли подматрицу, если есть столбец с ровно одним ненулём, разложили,
если нулевой "--- успех, если в каждом два ненуля, то там $+1$ и $-1$, т.е. сумма всех строк ноль, успех.
Аналогично показывается, что вполне унимодулярными являются матрицы базисов пр-в напряжений и циркуляций.
Матрица $M_i^*$ тоже вполне унимодулярна (в конспекте называется матрицей Кирхгофа, wtf).
Передоказываем старое утверждение: берём набор $S$ из $n-1$ ребра, $B_s$ есть подматрица
базисной матрицы пр-ва $B$ (думаем про $M_i$), столбцы которой взяли из $S$, тогда
$\det B_s \neq 0 \iff S$ образует остовное дерево.
Действительно $\det B_s = 0 \iff$ столбцы зависимы, т.е. есть циркуляция $f$,
носитель которой лежит в $S$, тогда подмножество $S$ содержит цикл, упс.
Обратно: пусть $S$ содержит цикл, тогда рассмотрим порождённую циркуляцию, столбцы
линейно зависимы.
Теорема: если $B$ "--- базисная пр-ва $B$, то $t(D)=\det(B_s \cdot B_s ^\top)$.
Берём Бине-Коши, $\det B_s$ по унимодулярности хорош, а по пред. утверждению получим ровно числол деревьев.
Следствие: можно подставить вместо $B$ матрицу $M_i^*$ (в конспекте "--- <<матрица Кирхгофа>>, wtf)

Рассчёт цепей: цикруляции "--- токи в цепи.
Пусть есть сопротивления между узлами (матрица $R$), тогда закон Ома ($U=IR$): $u=Ri+h$ (тут $h$ "--- источник
ЭДС мощностью $h$ по ребру, $i$ "--- ток по ребру, $u$ "--- разность потенциалов).
Первый закон Кирхгофа: $i$ есть циркуляция, т.е. $M_i\cdot i = 0$.
При этом $M_i^*$ всё еще базисная для $B$ (и называется матрицей Кирхгофа в конспекте, $K$), поэтому можно $K\cdot i = 0$.
Второй закон: на любом цикле падение ноль, но достаточно проверить на фундаментальных, берём $C=[f_{e_1}, \dots, f_{e_{m-n+1}}]$, тогда
$uC=0 \iff C^\top u=0$.
Омы и Кирхгофы дают систему уравнений на $u$, $i$, которую можно решать: построили дерево, записали уравнения, решили.
Можно еще как-то в матричном виде.
