\begin{theorem}
	Пусть $A$ и $B$ "--- вполне упорядоченные множества.
	Тогда одно из них изоморфно некоторому начальному отрезку другого.
\end{theorem}
\begin{Rem}
	Из этого, в частности, следует, что любые два вполне упорядоченных множества
	можно сравнить по мощности (если одно изоморфно подмножеству другого, то его мощность не больше).

	Потом докажем теорему Цермелло, которая гласит, что любое множество можно вполне упорядочить.
	Отсюда будет следовать, что любые два множества можно сравнить по мощности.
\end{Rem}
\begin{proof}
	Взяли два множества: $A$ и $B$.
	Хочется взять наименьший элемент и там, и там, сопоставить, потом выкинуть, взять
	следующий наименьший, <<и так далее>>.
	Хочется как-то это формализовать.

	Будем определять отображение $f \colon A \to B$ по принципу трансфинитной рекурсии.
	Введём правило для трансфинитной рекурсии: $f(a)$ "--- наименьший элемент $B$, который не встречается в $\{ f(x) \mid x < a \}$.
	Это не определено только в том случае, если $\{ f(x) \mid x < a \} = B$.
	По правилу трансфинитной рекурсии у нас есть однозначная функция $f$ (возможно, не везде определённая) и два случая:
	\begin{enumerate}
		\item
			$f$ определена на всём $A$.
			Тогда хотим понять, что $f(A)$ "--- это начальный отрезок, причём изоморфный $A$.

			Покажем, что $f$ "--- строго возрастающая функция.
			Возьмём две точки: $a$ и $b$ (пусть $a < b$).
			Заметим, что $f(a) \neq f(b)$, так как на шаге $b$ мы выбираем значение,
			точное не совпадающее с предыдущими значениями.
			Также заметим, что $f(a)$ не может быть больше $f(b)$, иначе бы
			на шаге $a$ мы бы выбрали $f(b) < f(a)$ в качестве минимального элемента.

			Теперь пишем условие того, что $f(A)$ "--- начальный отрезок:
			\[ \forall b \notin f(A) \colon \forall c \in f(A) \colon c < b \]
			В самом деле: если $c > b$, то мы бы на шаге $f^{-1}(c)$ выбрали бы
			элемент $b$ (он вообще ничьим образом не является) вместо $c$.

			Таким образом получили изоморфизм $A$ и начального отрезка $B$.

		\item
			Пусть $f$ определена на начальном отрезке $A$, не совпадающем с $A$: $f \colon [0, a) \to B$.
			Тогда ясно, что $f([0, a)) = B$, так как мы не смогли найти значение в точке $a$.

			Аналогично предыдущему случаю $f$ возрастает.
			То есть тоже получили изоморфизм $B$ и начального отрезка $A$.
      \end{enumerate}
\end{proof}

\begin{lemma}
	Никакое вполне упорядоченное множество не изоморфно своему собственному начальному отрезку (не совпадающему со всем множеством).
\end{lemma}
\begin{proof}
	В самом деле: пусть $A$ вполне упорядочено, $[0, a)$ "--- его начальный отрезок ($a \in A$)
	и есть изоморфизм $f \colon A \to [0, a)$.
	Тогда $f$ строго возрастает.
	А для возрастающей функции мы знаем, что $f(a) \ge a \notin [0, a)$, противоречие.
\end{proof}
\begin{conseq}
	Для двух вполне упорядоченных множеств $A$ и $B$ всегда выполняется ровно один из трёх вариантов:
	\begin{enumerate}
		\item $A$ изоморфно собственному начальному отрезку $B$
		\item $B$ изоморфно собственному начальному отрезку $A$
		\item $A$ изоморфно $B$
	\end{enumerate}
\end{conseq}
\begin{proof}
	Один из трёх выполняться должен (по теореме).
	Покажем, что не могут выполняться два сразу:
	\begin{itemize}
		\item
			Пусть $A$ изоморфно собственному начальному отрезку $[0, b) \subsetneq B$ (есть биекция $f$),
			а $B$ изоморфно собственному начальному отрезку $[0, a) \subsetneq A$ (есть биекция $g$).

			Тогда рассмотрим $g(f(A))$, это собственный начальный отрезок $A$
			($g(f(A)) = g([0, b)) \subset [0, a)$).

			Т.о. $A$ изоморфно собственному начальному отрезку, противоречие.

		\item
			Другая комбинации: пусть $A$ изоморфно собственному начальному отрезку $B$,
			а $B$ изоморфно $A$, тогда $B$ изоморфно собственному начальному отрезку $B$,
			противоречие.
	\end{itemize}
\end{proof}

\begin{Def}
	Аксиома выбора: пусть есть произвольное (в том числе несчётное) семейство
	непустых множество $A_i$, где $i \in I$.
	Тогда существует функция $f \colon I \to \bigcup A_i$ такая, что:
	\[ \forall i \in I \colon f(i) \in A_i \]
\end{Def}
\begin{conseq}\label{axiom_of_choice_phi}
	Пусть $A$ "--- множество.
	Давайте рассмотрим семейство $I=2^A \setminus \{A \}$.
	Тогда по аксиоме выбора есть функция $\phi$ из этого семейства в $A$ такая, что:
	\[ \forall x \subseteq A \colon \phi(x) \in A \setminus x \]
	В самом деле: положим $A_i = A \setminus i$.
\end{conseq}

\begin{theorem}[Цермелло]
	Всякое множество может быть вполне упорядочено.
\end{theorem}
\begin{Rem}
	Эта теорема эквивалента аксиоме выбора (без доказательства).
	Аксиома выбора не слишком конструктивна, поэтому вряд ли для теоремы есть конструктивное доказательство.
\end{Rem}
\begin{proof}
	Возьмём некоторую фиксированную функцию $\phi$ из \hyperref[axiom_of_choice_phi]{следствия к аксимое выбора}.

	Идея доказательства: возьмём элемент $\phi(\varnothing)$ и называем его <<минимальным>>.
	Следующий элемент (единицу) возьмём равным $\phi(\{ 0 \})$.
	Хочется сказать <<и так далее>>, но надо обосновать.

	\begin{Def}
		Назовём $(S, \le_S)$ (где $S \subseteq A$) корректным фрагментом,
		если $S$ "--- вполне упорядоченное множество (с порядком $\le_S$), а также для любого $a \in S$:
		\[ a = \phi([0, a)) \]
	\end{Def}
	\begin{lemma}
		Если есть два корректных фрагмента $(S_1, \le_{S_1})$ и $(S_2, \le_{S_2})$,
		то один является начальным отрезком другого (возможно, несобственным; например $S_1 \subseteq S_2$, причём
		$S_1=[0,s_2)$ для некоторого $s_2 \in S_2$) и на этом начальном отрезке порядки согласованы.
	\end{lemma}
	\begin{proof}
		Так как оба фрагмента являются в.у.м., то какое-то изоморфно начальному отрезку другого.
		Пусть $h \colon S_1 \to S_2$ "--- изоморфизм, причём $S_1$ изоморфно начальному отрезку $S_2$.
		Трансфинитной индукцией доказываем, что $h(x)=x$ (мы же помним, что $S_1, S_2 \subseteq A$, правда?).

		Зафиксируем некоторый $x \in S_1$, пусть при $y < x$ верно $h(y)=y$.
		Надо проверить, что $h(x)=x$.
		Рассмотрим начальный отрезок $[0, x)_{S_1}$.
		По изоморфности $h([0, x)_{S_1}) = [0, h(x))_{S_2}$.
		По предположению индукции $[0, x)$ и $[0, h(x))$  совпадают как множества.

		Так как $S_1$ и $S_2$ "--- коррекные фрагменты, из их определения можно написать:
		\begin{gather*}
			x = \phi([0, x)_{S_1}) \\
			h(x) = \phi([0, h(x))_{S_2})\\
			[0, x) = [0, h(x))\\
			\Ra \phi([0, x)) = \phi([0, h(x)) \\
			\Ra x = h(x)
		\end{gather*}
	\end{proof}

	Рассмотрим все корректные фрагменты: $(S_\alpha, \le_{S_\alpha})$.
	Рассмотрим $S = \bigcup S_\alpha$.
	Введём порядок $\le_S$ так: пусть $x, y \in S$,
	тогда $x \in S_1$, $y \in S_2$, тогда мы знаем, что либо $S_1$ изоморфно началу $S_2$,
	либо наоборот; откуда следует, что $x, y \in S_\alpha$ (для некоторого $\alpha$).
	Тогда можно определить $x \le_S y \iff x \le_{S_\alpha} y$.

	\begin{assertion}
		$S$ "--- вполне упорядоченное множество.
	\end{assertion}
	\begin{proof}
		Оно точно с линейным порядком (любые два сравнимы), осталось проверить отсутствие убывающих цепей.

		От противного: пусть есть убывающая цепь: $x_0 > x_1 > x_2 > \dots$.
		Мы знаем, что $x_0 \in S_\alpha$ (для некоторого $\alpha$).
		Покажем, что все $x_i \in S_\alpha$:
		рассмотрим какой-нибудь $x_i$, пусть он лежит в $S_\beta$.
		По лемме есть два случая:
		\begin{itemize}
			\item
				$S_\beta$ является начальным отрезком $S_\alpha$, тогда $S_\beta \subseteq S_\alpha$.
				Тогда, очевидно, $x_i \in S_\alpha$.
			\item
				$S_\alpha$ является начальным отрезком $S_\beta$: $S_\alpha = [0, c)_{S_\beta}$,
				то есть $x_i < x_0 < c$.
				Тогда $x_i < c$, т.е. $x_i \in S_\alpha$.
		\end{itemize}
		Тогда получаем, что у нас все элементы убывающей цепи лежат в $S_\alpha$,
		т.е. нашли в $S_\alpha$ бесконечную убывающую цепь, противоречие.
	\end{proof}
	Также знаем, что для $S$ верно:
	\[ \forall a \in S \colon a = \phi([0, a)) \]
	Значит, $S$ является корректным фрагментом.

	Теперь надо понять, что $S = A$.
	От противного: пусть $S \subsetneq A$, и $a = \phi(S)$ (помним, что тогда $a \notin S$)
	Тогда рассмотрим множество $S \cup \{a\}$, положим, что $a$ строго больше всех элементов $S$.
	Тогда результат всё еще будет вполне упорядоченным множеством: порядок всё еще линеен,
	и бесконечных цепей возникнуть от добавления одного элемента не могло.
	Значит, $S \cup \{a \}$ "--- тоже корректный фрагмент, однако $S$ равен объединению всех
	возможных корректных фрагментов, противоречие.
\end{proof}

\begin{lemma}[Цорн]
	Пусть $Z$ "--- частично упорядоченное множество, а для любой цепи $A \subseteq Z$
	(т.е. любые два элемента в $A$ сравнимы) существует верхняя граница $b \in Z$ такой, что $\forall a \in A \colon a \le b$.

	Тогда для любого элемента $a \in Z$ существуют некоторый максимальный элемент $m$ такой, что $m \ge a$
	(максимальный "--- такой, что нет строго больших его).
\end{lemma}
\begin{exmp}
	В любом векторном пространстве (в том числе бесконечномерном) есть базис.
	Базис "--- это максимальное подмножество линейно независимых векторов.
	\begin{proof}
		Пусть $Z$ "--- множество, содержащее все наборы линейно независимых векторов.
		Операция порядка "--- просто $\subseteq$.
		Давайте проверим, что любая цепь имеет максимальный элемент.
		Взяли цепь $A_i$.
		Рассмотрим набор векторов $\bigcup A_i$, покажем, что он тоже линейно независим.
		В самом деле: если он линейно зависим, то некоторая конечная линейная комбинация векторов
		линейна зависима, каждый из векторов содержится в некотором элементе цепи, можно выбрать
		максимальный из элементов цепи $A_i$, получили, что этот элемент сам по себе уже линейно зависим.

		Тогда по лемме Цорна получаем, что любое линейно независимое множество $A$ можно
		вложить в некоторое максимальное линейно независимое множество $A'$.
		Тогда $A'$ по определению является базисом.
		Мы даже доказали что-то более сильное.
	\end{proof}
\end{exmp}
\begin{proof}
	Доказываем лемму Цорна: рассмотрим множество $I$ "--- множество строго большей мощности, чем $Z$
	(например, $2^Z$).
	По теореме Цермелло вполне упорядочим $I$.
	Доказываем лемму Цорна от противного: пусть для некоторого элемента $a \in Z$ нет максимального элемента,
	больше либо равного $a$ (замечание: <<больше либо равно>> не есть <<не меньше>> в частично упорядоченном множестве).
	Теперь рассмотрим функцию $f \colon I \to Z$, положим $f(0)=a$, а остаток зададим трансфинитной рекурсией.
	Будем задавать $f(x)$.
	Положим $F=f\mid_{[0, x)}$.
	\begin{itemize}
		\item
			Если такое суженное $f$ не строго возрастает, то говорим, что $f(x)$ неопределено
		\item
			Если суженное $f$ строго возрастает, то $F$ есть цепь, пусть $s$ "--- верхняя граница этой цепи,
			причём $f(0) \in F$ и $a = f(0) \le s$.
			Тогда $s$ не может быть максимальным элементом, иначе $a \in s$.
			Тогда существует некоторый $t>s$, положим $f(x)=t$.
	\end{itemize}

	Два случая:
	\begin{itemize}
		\item
			Пусть $f$ определена только на $[0, b)$.
			Тогда $f\mid_{[0, x)}$ немонотонна, т.е. в каких-то двух точках $c < d$ имеем
			$f(c) > f(d)$.
			Но мы тогда, получается, неверно определили $f(d)$, так как на сооветствующем
			шаге в $F$ лежал элемент $f(c)$, и мы брали элемент, строго больший верхней границы,
			в частности, строго больший $f(c)$.
		\item
			Пусть $f$ определена на $I$.
			Тогда мы построили монотонно возрастающее отображение (т.е. инъекцию)
			из $I$ в $Z$ (откуда $|I| \ge |Z|$), но $|I| < |Z|$ (по построению $I$), противоречие.
	\end{itemize}
\end{proof}

\begin{exmp}\label{zorn_lemma_exmp_list_full}
	Пополнение списка формул до полного непротиворечивого.
	Пусть $\Gamma$ "--- непротиворечивый список пропозициональных формул,
	тогда существует $\Gamma' \supseteq \Gamma$ "--- полный непротиворечивый список (пополнение)
	\begin{proof}
		Вводим частично упорядоченное множество, элементы которого "--- непротиворечивые формулы $\Gamma$
		с данным множеством переменных.
		Отношение "--- включение.

		Давайте покажем, что у любой цепи $\Gamma_i$ есть верхняя граница.
		В самом деле, $\bigcup \Gamma_i$ есть набор формул, причём непротиворечивый,
		потому что противоречие всегда выводится из конечного множества формул.
		А тогда это конечное множество формул целиком лежит в каком-то из $\Gamma_i$
		(потому что среди конечного числа элементов цепи $\Gamma_i$ можно выбрать наибольший).

		Тогда существует максимальный элемент $\Gamma' \supseteq \Gamma$.
		Покажем, что $\Gamma'$ полон: в самом деле, если для некоторого $\phi$
		нельзя вывести ни $\phi$, ни $\lnot \phi$, то $\Gamma' \cup \{\phi \}$
		тоже непротиворечиво (было правило: если $\Gamma', \phi \vdash A, \lnot A$, то
		$\Gamma' \vdash \lnot \phi$).

		Таким образом, $\Gamma'$ полно.
	\end{proof}

	Для предикатных формул можно аналогично, но надо говорить про замкнутые формулы.
\end{exmp}

\begin{exmp}
	Если $A$ бесконечно, то $|A \times A| = |A|$.
	\begin{proof}
		Идея доказательства (деталей в этом доказательстве не будет):
		для некоторых подмножеств $A$ это верно (в частности, для счётных).
		Назовём подмножество \textit{хорошим}, если для него это верно.
		Далее будем рассматривать пары (подмножество, биекция) и введём порядок: подмножества вложены,
		а биекции согласованы.

		Тогда можно рассмотреть максимальную пару $(B, f)$, и что-то там показать.
	\end{proof}
\end{exmp}
