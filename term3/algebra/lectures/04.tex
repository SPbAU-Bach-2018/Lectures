\section{Изометрии}
Есть $V$ и $(,)$.
Интересующие нас ситуации:
\begin{enumerate}
    \item симметрическая, билинейная.
    \item кососимметрическая, билинейная.
    \item эрмитовосимметричная, полуторалинейная.
\end{enumerate}

\begin{Def}
	$\mathcal A \in \End(V)$ "--- изометрия $V$, $(,)$, если
	\[ \forall x, y \in V, (\mathcal A x, \mathcal A y) = (x, y) \]
\end{Def}

\begin{exmp}
	$\R^2$, поворот "--- изометрия.
\end{exmp}

\begin{theorem}
	$\dim V = n < \infty$, $\{e_i\} $ "--- базис $V$.
	$\Gamma$ "--- матрица Грама относительно базиса $\{e_i\}$.
	$A = [\mathcal A]_{\left<e_i\right>}$ "--- матрица линейного отображения $\mathcal A$.
	Тогда следующие условия равносильны:
	\begin{enumerate}
		\item $\mathcal A $ "--- изометрия.
		\item $A^T \Gamma \bar A = \Gamma$
	\end{enumerate}
\end{theorem}

\begin{proof}
	\begin{gather*}
		x \lra [x] = \begin{pmatrix} x_1\\ \dots\\ x_n\\ \end{pmatrix} \quad
		y \lra [y] = \begin{pmatrix} y_1\\ \dots\\ y_n\\ \end{pmatrix} \\
		[\mathcal A x] = A[x] \quad
		[\mathcal A y] = A[y] \\
		(x, y) = [x]^T \Gamma \overline{[y]} \\
		(\mathcal A x, \mathcal A y) = [x]^T A^T \Gamma \bar A  \overline{[y]}
	\end{gather*}
	\begin{description}
	\item[$2 \Ra 1$:]
		Очевидно.

	\item[$1 \Ra 2$:]
		\[
			\forall [x][y]\colon [x]^T A^T \Gamma\bar A \overline{[y]} = [x]^T  \Gamma \overline{[y]}
		\]
		Значит, в частности, для следующих векторов это тоже верно:
		\[
			[x] = \begin{pmatrix} 0 \\ \vdots \\ 0 \\ 1\\ 0 \\ \end{pmatrix} \quad
			[y] = \begin{pmatrix} 0\\ 1\\ 0\\ \vdots \\ 0\\ \end{pmatrix}
		\]
		Таким образом, мы можем <<выбрать>> из матриц $A^T \Gamma \bar A$ и $\Gamma$ произвольный элемент $\Gamma_{ij}$ (он окажется одинаковый с двух сторон).
		Получаем:
		\[
			(A^T \Gamma \bar A )_{ij} = \Gamma_{ij} \Ra A^T \Gamma \bar A  = \Gamma
		\]
	\end{description}
\end{proof}

\begin{conseq}
	Так как форма невырожденная, то изометрия "--- обратимое преобразование.
\end{conseq}
\begin{proof}
	\[ A^T \Gamma \bar A  = \Gamma, \det \Gamma \ne 0 \Ra \det A \ne 0 \]
	$A = [\mathcal A]$ обратима, значит $\mathcal A$ обратимо.
\end{proof}

\begin{conseq}
	Изометрии пространства $V$, $(,)$ образуют группу (относительно композиции).
\end{conseq}
\begin{proof}
	$id_V $  "--- изометрия.
	Проверим композицию:
	\[ (\mathcal A \mathcal B x, \mathcal A \mathcal B y) = (\mathcal B x, \mathcal B y) = (x, y) \]
	Проверим наличие единицы и обратимость:
	\begin{gather*}
		[\mathcal A ] = A \quad [\mathcal A ^{-1}] = A ^{-1} \\
		E = [\mathcal A \mathcal A ^{-1}] = [\mathcal A] [\mathcal A ^{-1}] \\
		A^T \Gamma \bar A  = \Gamma \\
		\Gamma = (A^T)^{-1} \Gamma (\bar A)^{-1} = (A^{-1})^T \Gamma \overline{(A^{-1})}
	\end{gather*}
	$\mathcal A^{-1}$ "--- изометрия.
\end{proof}

\begin{Def}
	$V$ "--- векторное конечномерное пространство над $K$. $\dim V = n < \infty$
	$B = (,)$ "--- невырожденная, симметричная билинейная форма.

	Группа изометрии $O(V, B)$ называется ортогональной группы связанной с формой $B$.
	В частности, если $V = \R^n$ "--- евклидово пространство с $(x, y) = \sum x_i y_i$,
	то $O(n)$ "--- вещественная ортогональная группа.
\end{Def}
В $\R^n$ могут быть билинейные формы
\[ \sum_{i = 1}^p x_iy_i - \sum_{i = p + 1}^{p + q} x_i y_i \quad O(p, q) \quad p + q = n \]
$O(1, 3)$ "--- группа изометрий пространства Минковского.

Любая билинейная форма будет эквивалента одной из этих.
Это будет показано позже.

\begin{Def}
	$B$ "--- кососимметрическая, билинейная.
	Группа изометрий $(V, B)$ "--- симплектическая группа.
	\[ Sp(V, B) \]
\end{Def}

\begin{exmp}
	\begin{gather*}
		\Gamma_B = \begin{pmatrix} 0 & -E_n \\ E_n & 0 \\ \end{pmatrix} \\
		K^{2n} \quad Sp(K^{2n}, B)
	\end{gather*}
	Симплектические группы исчерпываются группами, заданными такой матрицей Грамма.
\end{exmp}

\begin{Def}
	$K$ "--- поле с инволюцией.
	$B$ "--- эрмитовосимметричная, полуторалинейная, невырожденная.
	Группа изометрий пространства $(V, B)$ называется унитарной группой, отвечающей форме $B$.
	\[ U(V, B) \]
\end{Def}

\begin{exmp}
	$V = \C^n$.
	\begin{description}
	\item[$U(n)$:]
		\[ \sum_{i=1}^n x_i \bar y_i \]

	\item[$U(p, q)$:]
		\[ \sum_{i=1}^p x_i \bar y_i - \sum_{i=p+1}^{p+q} x_i \bar y_i \]
	\end{description}
\end{exmp}

\subsection{Матричная интерпретация}

$O(n)$ %%WAT?
$\R^n$ "--- евклидово пространство, $e_1, \dots, e_n$ "--- стандартный базис, $\Gamma = E$, $A = [\mathcal A]$.

\begin{Def}
	Изометрии евклидова пространства соотвествуют \textit{ортогональным операторам}.
\end{Def}
\[ A^T A = E \Lra A^{-1} = A^T \]
\begin{Def}
	$A \in M(n, \R)$ называется ортогональной, если
	\[ A^{-1} = A^T \]
\end{Def}

Ортогональная матрица "--- это матрица ортогонального оператора в евклидовом пространстве.

\begin{conseq}[Ортогональных матриц]
	$A$ "--- ортогональная матрица.
	\[ A = \begin{pmatrix} A_1 & \cdots & A_n\end{pmatrix} \]
	$A$ "--- ортогональная тогда и только тогда, когда $A_i$ попарно ортогональны и единичной длины.

	$A^T A = E$ означает, что произведение разных столбцов дает 0, а самого на себя дает 1.
	То есть это просто переформулировка условия ортогональности.
	Но, оказывается, тоже самое верно и для строк.
	\[ A = \begin{pmatrix} A_1 \\ \vdots \\ A_n \\ \end{pmatrix} \]
	$A$ "--- ортогональныая тогда и только тогда, когда строки попарно ортогональны и единичной длины.
	\begin{gather*}
		A^T A = E \Ra A^T  = A^{-1} \\
		A A^T  = A A^{-1} = E \\
		A A^T = E
	\end{gather*}
	$\mathcal A$ "--- ортогональный оператор в евклидовом пространстве тогда и только тогда,
	когда $\mathcal A$ переводит ортонормированный базис в ортонормированный.
	\begin{proof}
		Пусть $\{e_i\}$ "--- ортонормированный базис, $\Gamma_{\{e_i\}} = E$.
		Знаем:
		\[
			(\mathcal A e_i, \mathcal A e_j)_{ij} = (e_i,e_j)_{i, j} = E \\
		\]
		Теперь возьмём два произвольных вектора с координатами $a_i$ и $b_i$ и проверим, что скалярное произведение не меняется
		(то есть $\mathcal A$ являеется изометрией евклидова пространства):
		\begin{gather*}
			\left(\mathcal A \left(\sum a_i e_i\right), \mathcal A \left(\sum b_i e_i\right)\right) = \\
			\left(\sum a_i (\mathcal A e_i), \sum b_i (\mathcal A e_i\right) = \\
			=
				\begin{pmatrix} a_1 & \cdots & a_n \end{pmatrix}
				(\mathcal A e_i \mathcal A e_j)_{i, j}
				\begin{pmatrix} b_1 \\ \vdots \\ b_n \end{pmatrix}
			=
				\begin{pmatrix} a_1 & \cdots & a_n \end{pmatrix}
				\begin{pmatrix} b_1 \\ \vdots \\ b_n \\ \end{pmatrix} = \\
			= \left(\sum a_i e_i, \sum b_i e_i \right)
		\end{gather*}
	\end{proof}
\end{conseq}

\begin{exmp}
	$O(1)$ "--- вещественная ортогональная группа для пространства размерности 1.
	\begin{gather*}
		a^T a = 1 \quad a \in \R \\
		a = \pm 1 \\
		O(1) = \{\pm 1\}
	\end{gather*}
\end{exmp}
\begin{exmp}
	$O(2)$
	\begin{gather*}
		A = \begin{pmatrix} a & c \\ b & d \\ \end{pmatrix} \\
		\begin{pmatrix} a & b \\ c & d \\ \end{pmatrix} \begin{pmatrix} a & c \\ b & d \\ \end{pmatrix} = E \\
		\left\{\begin{aligned}
			a^2 + b^2 &= 1 \\
			c^2 + d^2 &= 1 \\
			a c + b d &= 0
		\end{aligned}\right.
	\end{gather*}
	$A$ ортогональный, значит $\det A = \pm 1$ (так как $|A^TA|=|A^T||A|=|A|^2=|E|^2=1$).
	Положим
	\[
		SO(n) = \{ A \in O(n) \mid \det A = 1\} \\
	\]
	Тогда $O(2)$ порождается следующим множеством матриц:
	\[
		O(2) = \langle SO(2) \cup \begin{pmatrix} 1 & 0 \\ 0 & -1 \\ \end{pmatrix} \rangle
	\]

	Матрицы с определителем 1:
	\[\left\{\begin{aligned}
		a^2 + b^2 &= 1 \\
		c^2 + d^2 &= 1 \\
		a c + b d &= 0 \\
		a d - b c &= 1
	\end{aligned}\right.\]
	Запишем то же самое по строкам.
	\[\left\{\begin{aligned}
		a^2 + c^2 &= 1 \\
		b^2 + d^2 &= 1 \\
		a b + c d &= 0 \\
		a d - b c &= 1
	\end{aligned}\right.\]
	Делаем выводы, что
	\begin{align*}
		a &=  \cos(\Phi) & c &= \sin(\Phi) \\
		b &= -\sin(\Phi) & d &= \cos(\Phi)
	\end{align*}
	$c \ne \sin(\Phi)$ так как не подойдет под одно из условий.

	Тогда матрица имеет вид:
	\[\begin{pmatrix}
		\cos \Phi & -\sin \Phi \\
		\sin \Phi &  \cos \Phi
	\end{pmatrix}\]
\end{exmp}
\begin{exmp}
	$V = \C^n$ "--- унитарное пространство.
	Изометрия $\mathcal A$ называется  унитарным оператором, а его матрица $A$ в стандартном базисе называется унитарной матрицей.
	$A \in M(n, \C)$, $\Gamma = E$.
	\begin{gather*}
		A^T \bar A  = E \\
		\bar A^T A = E \\
		A^{-1} = \overline{A^T}
	\end{gather*}
	\textbf{Упражнение:} $\mathcal A$ "--- унитарный тогда и только тогда, когда ортонормированный базис переводит в ортонормированный.
\end{exmp}
\begin{exmp}
	$U(1)$:
	\begin{gather*}
		a^T \bar a  = 1 \\
		|a| = 1 \\
		U(1) = S_1 \sim SO(2) \\
		SU(2) \to SO(3)
	\end{gather*}
\end{exmp}
