\setcounter{section}{17}
\section{Билет 18 (лемма Шварца-Циппеля)}
	\begin{Def}
		Степень одночлена от нескольких переменных "--- сумма степеней по каждой переменной.
	\end{Def}
	\begin{Def}
		Степень многочлена от нескольких переменных "--- максимум степеней его одночленов.
	\end{Def}
	\begin{exmp}
		\[ \deg (x^2+y^2) = 2 \]
	\end{exmp}
	\begin{exmp}
		\[ \deg (x^2y + y^2) = 3 \]
	\end{exmp}
	\begin{Def}
		Многочлен от нескольких переменных называется \textit{тождественно равным нулю}, если все его коэффициенты равны нулю, т.е. нет ни одного одночлена с ненулевым коэффициентом.
		Обозначется $q(x_1, \dots, x_n) \equiv 0$.
	\end{Def}

	\begin{lemma}
		Пусть есть поле $F$, некоторое его конечное подмножество $S \subseteq F$ и многочлен $Q$ (не равный тождественно нулю) от $n$ переменных степени не больше $d$.
		Тогда если выбрать значения $x_i$ независимо и равновероятно из множества $S$, то вероятность попасть в корень многочлена не больше $\frac{d}{|S|}$.
	\end{lemma}
	\begin{proof}
		Индукция по числу переменных $n$.
		\begin{description}
			\item[База:] $n=1$.
				Мы знаем, что над полем у многочлена от одной переменной степени $d$ не более $d$ корней.
				\begin{Rem}
					Это следствие теоремы Безу, которая работает в произвольном поле: если $c$ "--- корень многочлена, то он делится на $x-c$ без остатка.
					Многочлен неотрицательной степени можно поделить не более $d$ раз на разные корни, разложить в произведение линейных и какого-то неприводимого,
					получить не более $d$ корней.
				\end{Rem}
				Значит, в множестве $S$ тоже лежит не более $d$ корней.
				Значит, вероятность попасть в случайный не более $\frac{d}{|S|}$.
			\item[Переход:] $(n-1) \to n$.
				Пусть у нас всё доказано для многочленов от $n-1$ переменной и есть многочлен $Q(x_1, \dots, x_{n-1}, x_n)$.
				Давайте сгруппируем его одночлены по степеням $x_n$:
				\begin{gather*}
					Q \in F[x_1, \dots, x_n] \\
					Q(x_1, \dots, x_n) = x_n^d \cdot q_d(x_1, \dots, x_{n-1}) + \dots + x_1 \cdot q_1(x_1, \dots, x_{n-1}) + q_0(x_1, \dots, x_{n-1}) \\
					q_i \in F[x_1, \dots, x_{n-1}]
				\end{gather*}
				Так как $Q$ не является тождественным нулём, то хотя бы один многочлен из $q_i$ не является тождественным нулём.
				Давайте обозначим такое максимальное $i$ за $k$, получим:
				\[
					Q(x_1, \dots, x_n) = x_n^k \cdot q_k(x_1, \dots, x_{n-1}) + \dots + q_0(x_1, \dots, x_{n-1})
				\]
				Можно переобозначить этот многочлен за $Q_{x_1,\dots, x_{n-1}}(x_n)$.

				Два случая:
				\begin{enumerate}[label=\emph{\Alph*}.]
					\item $Q_{x_1, \dots, x_{n-1}}(x_n)\equiv 0$ (т.е. ноль независимо от $x_n$).
					\item $Q_{x_1, \dots, x_{n-1}}(x_n)\nequiv 0$
				\end{enumerate}
				Пусть вероятность попасть в случай \emph{A} при случайных $x_1, \dots, x_{n-1}$ равна $p$, тогда вероятность попасть в \emph{B} равна $1-p$.
				Разберёмся в каждом случае, какая вероятность выбрать $x_n$ так, чтобы $Q(x_1, \dots, x_n)=0$.
				\begin{enumerate}[label=\emph{\Alph*}.]
					\item
						многочлен оказался тождественным нулём.
						Значит, независимо от выбора $x_n$ верно $Q_{\dots}(x_n)=0$, вероятность "--- 1.
					\item
						многочлен $Q_{x_1, \dots, x_{n-1}}(x_n) \nequiv 0$.
						Этот многочлен имеет степень не больше $k$, значит, как в базе индукции, вероятность того, что он занулится
						при случайном $x_n$ не более $\frac{k}{|S|}$.
				\end{enumerate}
				\begin{assertion}
					Многочлен $Q$ зануляется (при случайных $x_1, \dots, x_n$) с вероятностью не более $p + \frac{k}{|S|}$.
				\end{assertion}
				\begin{proof}
					В самом деле "--- с вероятность не более $p$ имеем случай \emph{A} (в котором многочлен зануляется) и с вероятностью не более 1 имеем
					случай \emph{A}, в котором многочлен зануляется с вероятностью $\frac{k}{|S|}$.
				\end{proof}

				Оценим $p$ сверху.
				Чтобы $Q_{x_1, \dots, x_{n-1}}$ оказался тождественным нулём надо, в частности, чтобы его старший коэффициент ($q_k$) стал нулём.
				Так как $\deg q_k = d - k$, то, по предположению индукции, это событие произойдёт с вероятностью не большей $\frac{d-k}{|S|}$.
				Значит, $p < \frac{d-k}{|S|}$.

				Таким образом, исходный многочлен $Q$ зануляется с вероятностью не более:
				\[ \frac{d-k}{|S|} + \frac{k}{|S|} = \frac{d}{|S|} \]
				Что и требовалось показать.
		\end{description}
	\end{proof}

	\begin{Def}
		\textit{Задача проверки полинома на тривиальность}: имеется формальный полином $Q$ от $n$ переменных и некоторое фиксированное поле $F$.
		При этом мы можем вычислять значения этого полинома в произвольной точке поля за полиномиальное время.

		Требуется проверить, является ли этот полином тождественным нулём (то есть равны ли все его коэффициенты нулю).
	\end{Def}
	\begin{exmp}
		Например, может быть дан такой полином в поле $\Z_{2^{2n}}$ (он, очевидно, тождественно равен нулю):
		\[
			(x_1-x_2)(x_1-x_2)\dots (x_1-x_n) - (x_1-x_2)(x_1-x_2)\dots (x_1-x_n)
		\]
		Однако так сходу это может быть неясно.
		Если мы начнём честно раскрывать и приводить подобные слагаемые, мы получим экспоненциальный рост размера полинома, что нехорошо.
	\end{exmp}
	\begin{Rem}
		Многочлен $2x$ в поле $\R$ не является тождественным нулём, а вот в поле $\Z_2$ "--- уже является.
	\end{Rem}
	\begin{assertion}
		Задача проверки полинома на тривиальность (в достаточно большом поле) лежит в $\co\RP$ (ответ <<да>> "--- полином тождественный ноль, ответ <<нет>> "--- не тождественный ноль).
	\end{assertion}
	\begin{proof}
		Пусть дан полином от $n$ переменных степени $k$.
		Тогда давайте выберем в поле $F$ $n$ случайных чисел в качестве значений переменных и подставим их в полином.
		Если получился не ноль, то мы уверены в том, что полином не является тождественным нулём.
		Иначе по лемме вероятность того, что полином не является тождественным нулём не превосходит
		\[
			\frac{k}{|F|}
		\]
		Так как мы случайно попали в корень.
		Если поле имеет размер хотя бы $(1+\epsilon) \cdot k$, то вероятность ошибки отделима от единицы.
	\end{proof}
