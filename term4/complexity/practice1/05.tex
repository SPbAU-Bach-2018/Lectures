\chapter{Занятие 09.03.2016}

\section{Разбор задач}
\subsection{Задача 10}\index{10@Задача 10!От Пети}
	Разбирал Петя Смирнов.

	\subsubsection{Немного теории чисел}
		\begin{Def}
			Пусть $m$ "--- положительное натуральное число, $a$ "--- некоторый остаток по этому модулю.
			Тогда $d(a)$ "--- \textit{показатель $a$} "--- минимальное натуральное $k>0$ такое,
			что $a^k \equiv 1 \mod m$ (если такое существует).
		\end{Def}
		\begin{Rem}
			Для любого $a$, взаимно простого с $m$, показатель определён.
		\end{Rem}
		\begin{assertion}
			Если $a^x \equiv 1 \mod m$, то $x \vdots d(a)$.
		\end{assertion}
		\begin{proof}
			От противного: пусть $x=k\cdot d(a) + r$, причём $0 < r < d(a)$.
			Тогда:
			\begin{align*}
				a^x &\equiv 1 \\
				a^x &\equiv \underbrace{a^{d(a)} \cdot \dots \cdot a^{d(a)}}_{k} \cdot a^r \equiv \\
				&\equiv \underbrace{1 \cdot \dots \cdot 1}_{k} \cdot a^r = a^r \\
				a^r &\equiv 1
			\end{align*}
			Таким образом получаем противоречие: $r<d(a)$, значит, $d(a)$ не является индексом.
		\end{proof}
		\begin{conseq}
			$d(a)\mid\phi(m)$, так как $a^{\phi(m)} \equiv 1$.
		\end{conseq}

		\begin{lemma}\label{day160309_criterion_order}
			Пусть $(a, m)=1$.
			Тогда $d$ является показателем $a$ по модулю $m$ тогда и только тогда, когда выполнено всё следующее:
			\begin{enumerate}
				\item $a^d \equiv 1 \mod m$
				\item Для каждого простого $q \mid d$: $a^{\sfrac dq} \nequiv 1 \mod m$
			\end{enumerate}
		\end{lemma}
		\begin{Rem}
			Смысл такой: чтобы проверить, что ни в какой из меньших степеней $a$ не даёт единицу,
			то достаточно проверять только все делители $d$, более того "--- достаточно лишь
			<<пооткусывать>> по одному простому делителю от $d$.
		\end{Rem}
		\begin{proof}
			В одну сторону очевидно: если $d$ "--- показатель, то условия верны,
			т.к. $\frac dq < d$.
	
			В другую сторону от противного: пусть на самом деле показателем является число $x$.
			Очевидно, что $x < d$.
			Также понятно, что $x \mid d$ (уже поясняли выше).
			Теперь давайте найдём простое число $q$ такое, что $x$ всё еще делит $\frac d q$.
			Для этого возьмём произвольный простой делитель $q$ числа $\frac d x$.
			Тогда $x \le \frac d q < d$.
			А тогда мы знаем, что $a^{\sfrac dq} = \left(a^x\right)^{\dots} \equiv 1 \mod m$.
		\end{proof}

		\begin{lemma}
			Число $p$ простое тогда и только тогда, когда существует такой остаток $a$ по модулю $p$,
			что $d(a)=p-1$.
		\end{lemma}
		\begin{proof}
			Если $p$ "--- простое, то мы берём в качестве $a$ любой первообразный корень по модулю $p$.
	
			В обратную сторону: посмотрим на $\phi(p)$.
			Оно всегда не больше $p-1$.
			Также мы знаем, что $d(a)\mid \phi(p)$, т.е. $d(a) \le p-1$.
			А равенство может достигнуться только в случае $\phi(p)=p-1$, а такое бывает только для простых чисел.
		\end{proof}
	
	\subsubsection{Пункт <<а>>, часть I}
		Сначала стрелка слева направо: пусть $n$ "--- простое.
		Тогда есть первообразный корень $\xi$, тогда он для любого $q$
		подойдёт в качестве $a$: $\xi^{\frac{n-1}{q}} \nequiv 1 \mod n$.

		В обратную сторону: давайте мы сначала поймём, что же значат наши дурацкие условия.

		Рассмотрим какой-нибудь вычет $a$, подошедший для числа $q_1$.
		Мы знаем, что у $a$ есть показатель, так как в некоторой степени оно дало единицу.
		Также мы знаем, что этот показатель делит $n-1$, так как $a^{n-1}\equiv 1$.
		Давайте разложим $n-1$ и $d(a)$ на простые множители:
		\begin{gather*}
			n-1 = q_1^{\alpha_1}q_2^{\alpha_2}\dots q_k^{\alpha_k} \\
			d(a) = q_1^{\beta_1}q_2^{\beta_2}\dots q_k^{\beta_k} \\
			a^{\frac{n-1}{q}} = a^{q_1^{\alpha_1-1}}a^{q_2^{\alpha_2}}\dots a^{q_k^{\alpha_k}} \nequiv 1 \\
		\end{gather*}
		Так как $d(a) \mid n-1$, то мы знаем, что $0 \le \beta_i \le \alpha_i$.
		\begin{assertion}
			$\beta_1 = \alpha_1$
		\end{assertion}
		\begin{proof}
			От противного: пусть $\beta_1 < \alpha_1$, т.е. $\beta_1 \le \alpha_1-1$.
			Тогда, посмотрев строчку с $a^{\frac{n-1}{q}}$ и разложением $\frac{n-1}{q}$, можно понять, что
			число $\frac{n-1}{q}$ делится на $d(a)$.
			То есть $a^{\frac{n-1}{q}} \equiv 1$.
			Получаем противоречие.
		\end{proof}

		Дальше план такой: мы рассмотрим какой-нибудь простой делитель $q_i$ числа $n-1$ и подошедшее для него число $a_i$.
		Мы знаем, что $d(a_i)=q_1^{\beta_{i1}}q_2^{\beta_{i2}}\dots q_i^{\alpha_i} \dots q_k^{\beta_{ik}}$ (так как $\beta_{ii}=\alpha_i$ по утверждению).
		Дальше все числа $a_i$ мы переделаем в числа $b_i$ так, что $d(b_i)=q_i^{\alpha_i}$.
		После этого положим $\xi = \prod b_i$ и автоматически получим (см.ниже), что $d(\xi)=n-1$, а тогда $n$ простое.

	\subsubsection{Поведение показателей при произведении}
		\begin{lemma}
			Пусть $a$, $b$ "--- остатки по модулю $m$, причём $(a, m)=(b, m)=1$.
			Обозначим $d(a)=d_1$, $d(b)=d_2$.
			Тогда если $(d_1, d_2)=1$, то $d(ab)=d_1d_2$.
		\end{lemma}
		\begin{proof}
			По критерию \ref{day160309_criterion_order} проверим, что $d_1d_2$ является показателем.
			Сначала проверим вот это:
			\begin{gather*}
				(ab)^{d_1d_2} \stackrel{?}{\equiv} 1 \\
				(ab)^{d_1d_2} = a^{d_1d_2}b^{d_1d_2} = (a^{d_1})^{d_2}(b^{d_2})^{d_1} \equiv 1 \cdot 1 = 1 \\
			\end{gather*}
			Теперь второй пункт критерия: берём простой делитель $q$ числа $d_1d_2$.
			Так как $q$ "--- простое, то не умаляя общности можно считать, что $p\mid d_1$
			(обозначим $d_1=pk$).
			Теперь переписываем:
			\begin{gather*}
				(ab)^{\frac{d_1d_2}q} =
				(ab)^{kd_2} =
				a^{kd_2} b^{kd_2} =
				a^{kd_2} \left(b^{d_2}\right)^{k} \equiv
				a^{kd_2} \cdot 1
			\end{gather*}
			Но так как $d_2$ и $d_1$ взаимно просты, то $kd_2$ не может делится на $d_1$,
			следовательно, $a^{kd_2} \nequiv 1$.
		\end{proof}
		\begin{Rem}
			А если не взаимно просто, то может происходить полная чушь.
			Например, по модулю 5 верно: $d(2)=4$.
			Однако $d(2\cdot 2)=d(4)=2$.
		\end{Rem}

	\subsubsection{Пункт <<а>>, часть II}
		\begin{lemma}
			Пусть $(a, m)=1$ и $d(a)\vdots k$.
			Тогда $d(a^k) = \frac{d(a)}{k}$.
		\end{lemma}
		\begin{proof}
			Опять пользуемся критерием \ref{day160309_criterion_order}.
			Очевидно, что $(a^k)^{\sfrac{d(a)}{k}} = a^{d(a)} \equiv 1$.
			Дальше нужно проверить вторую часть (минимальность), но мы этого делать
			не стали "--- должно быть практически точным повторением того, что делали чуть выше:
			берём простой делитель $\frac{d(a)}{k}$, пробуем делить, получаем противоречие с минимальностью
			$d(a)$.
		\end{proof}
		Это и есть способ переделки $a_i$ в $b_i$.
		Мы берём очередное $a_i$, и возводим его вот в такую степень:
		\[
			q_1^{\beta_{i1}} \cdot
			q_2^{\beta_{i2}} \cdot
			\dots \cdot
			q_{i-1}^{\beta_{i{i-1}}} \cdot
			q_{i+1}^{\beta_{i{i+1}}} \cdot
			\dots \cdot
			q_k^{\beta_{ik}} \]
		Получили $b_i$, причём $d(b_i)=q_i^{\alpha_i}$.

	\subsubsection{Пункт <<б>>}
		Пункт <<а>> мы не используем.
		Хотим придумать какую-нибудь подсказку, которая бы нам доказала простоту $n$.
		Давайте в неё включим разложение $n-1$ на простые множители:
		\[ n-1 = q_1^{\alpha_1} \cdot \dots \cdot q_k^{\alpha_k} \]
		Длина входа равна $\log n$, простых делителей $n-1$ не больше $\log n$,
		стало быть, длина разложения "--- $O(\log^2 n)$.

		Также добавим в подсказку первообразный корень $\xi$ по модулю $n$.
		Для проверки надо возвести его в степени $\frac{n-1}{q_i}$ и проверить, что
		мы не получаем единицу по модулю $n$;
		а потом возвести в степень $n-1$ и проверить, что получилась единица.
		
		Часть подсказки с разложением также легко верифицируется:
		\begin{itemize}
			\item Надо проверить, что все $q_i$ различны и в произведении дают $n-1$
			\item
				Надо проверить, что все $q_i$ простые.
				Это мы делаем рекурсивно, добавляя подсказку для каждого из них.
				\begin{Rem}
					Надо как-то оценить суммарную длину всех подсказок, включая рекурсивные.
					Пусть изначальное число $n$ имело длину $l$.
					Тогда запись его разложения занимает $O(l)$ бит,
					так как при умножении двух чисел длина результата не больше суммы длин исходных,
					а мы еще и $\alpha_i$ отдельно записываем вместо повтора $q_i$ несколько раз,
					что также сокращает длины.
					Еще надо записать $\xi$ "--- это еще $O(l)$ бит.

					То есть получаем, что без учёта рекурсивных подсказок на сертификат для числа $n$
					надо $O(|n|)$ бит.
					Заметим, что глубина рекурсивных подтверждений не может быть больше $O(|n|)$,
					так как на каждом шаге длина максимального множителя в разложении уменьшается хотя бы
					в два раза: если было простое число $n$, то число $n-1$ не может быть простым (за исключением
					тривиального случая),
					стало быть, оно состоит хотя бы из двух множителей, и минимальный из них хотя бы двойка.

					Тогда если мы нарисуем картинку со всеми подсказками, то мы получим $O(|n|)$ уровней,
					а на каждом в сумме $O(|n|)$ подсказок для чисел на этом уровне.
					Итого $O(|n|^2)$ бит на всё-провсё, полином.
				\end{Rem}
		\end{itemize}

\subsection{Задача 10 (альтернатива)}\index{10@Задача 10!От семинариста}
	Разбирал семинарист.
	В одну сторону всё так же очевидно.
	А в другую сторону мы будем показывать неконструктивно, от противного.
	Доказываем следующее утверждение: если нужные $a$ найдутся, то $n$ "--- простое.

	Давайте покажем, что если $n$ не является простым, то с каким-то $q$ обязательно возникнут проблемы.
	Возьмём следующие числа:
	\begin{align*}
		k &\coloneq \textrm{НОД}(n-1, \phi(n)) \le \phi(n) < n - 1 \\
		q' &\coloneq \frac{n-1}{k} \\
		q &\coloneq \text{произвольный простой делитель $q'$} \\
		q_0 &\coloneq \frac{q'}{q} = \frac{n-1}{kq} \\
	\end{align*}
	Найдём для $q$ соответствующее $a$.
	Мы знаем, что $a^{n-1} \equiv 1$ (по условию) и что $a^{\phi(n)} \equiv 1$ (теорема Эйлера).
	Отсюда следует, что $a^k \equiv 1$.
	Тогда увидим, что всё поломалось и есть противоречие:
	\begin{gather*}
		kq_0 = \frac{n-1}q \\
		a^{\frac{n-1}{q}} = a^{kq_0} = (a^k)^{q_0} \equiv 1^{q_0} = 1
	\end{gather*}

\problem{25}
	Разбирал Сева Степанов.

	Возьмём язык следующего вида: $L = \{1^n \mid n \in X\}$, а множество
	$X$ мы сейчас определим.
	Очевидно, что этот язык схемами принимается: мы для каждой длины должны построить схему,
	которая либо выдаёт константный ноль (если длина плохая), либо проверяет, что вход состоит
	из один единиц.
	Возьмём в качестве $X$ какое-нибудь неразрешимые множества, они у нас были в прошлом семестре.
	Тогда они, в частности, машиной Тьюринга за полином точно не разрешаются.

\section{Подсказки}
\subsection{Задача 26}
	Подсказка из условия в следующем: вспомнить доказательство $\Sigma_2 \subseteq SIZE[n^k]$
	и сделать по аналогии.
	$SIZE[n^k]$ "--- это языки, разрешающиеся схемами, причём схема для входа размера $n$ имеет размер $O(n^k)$.
	Задача является обобщением-вариацией теоремы с лекции.

	Есть штука под названием <<Complexity Zoo>>.
	Если её вбить в гугл, то должен появиться сайт со списком всех известных человечеству классов сложности.
	Например, всякие классы вроде $O_2$, $S_2$, $\Sigma_1$, $\Sigma_2$.

\subsection{Задача 20}
	Предлагается посмотреть на полные задачи для класса $\NP$, тогда какие-то пункты должны стать очевидны.

\subsection{Задача 21}
	Предлагается вспомнить задачу 13, причём \hyperref[prob13_sol2]{решение с дописыванием единичек}.

\subsection{Задача 27}
	Предлагается посмотреть на какие-нибудь теоремы об иерархии.
	Мы уже на практиках доказывали, что $\P \neq \EXP$, а на лекциях доказывали, что-то похожее про память.
