\chapter{Занятие 06.04.2016}

\TODO расписать точнее, что значит <<за полином от $\alpha$ запусков мы делаем вероятность ошибки $2^{-\alpha}$>>

\section{Разбор задач}
\problem{47}
	Разбирал Сева Степанов и завалился.
	Потом решение доделал Петя Смирнов.

	Одно включение очевидно: $\BPP \subseteq \BPP^{\BPP}$.
	Теперь в другую сторону.
	У нас есть машина, которая использует оракул для некоторого языка
	$L\in\BPP$, который умеет за один шаг точно говорить, принадлежит ли слово языку.
	\begin{Rem}
		Для $\BPP$ машины не циклятся.
	\end{Rem}
	Давайте теперь в этой машине заменим вызовы оракула на явное вычисление оракула.
	Правда, теперь оракул может начать ошибаться.

	И вот тут возникает проблема: потенциально можно работать бесконечное время.

	Потом вышел Петя и сказал, что можно навесить полиномиальный будильник на нижнюю машину из $\BPP$.
	Машина работает $T(n)$.
	Алгоритм $A$ "--- это алгоритм, который почти оракул, но может ошибаться.
	Понизим вероятность ошибки оракула до $\frac{1}{2^{n}}$, для этого его надо запустить $s(n)$ раз.
	У нас было $T(n)$ вызовов оракула, надо, чтобы все отработали верно.
	Посчитаем $P_{\Sigma}$ (все оракулы ответили правильно):
	\[
		\left(1 - \frac{1}{2^n}\right)^{T(n)}
		по Бернулли
		\ge
		1 - \frac{T(n)}{2^n}
	\]
	Тогда мы ответим верно с вероятностью $\sfrac9{10} P_\Sigma$ (мы понизили ошибку нижнего алгоритма до $\sfrac9{10}$.
	Ну, $P_{\Sigma}$ с некоторого $n$ будет достаточно большим, что и требовалось.
	Для мелких $n$-то мы можем зашить все ответы точно, это будет $\O(1)$ времени и памяти.

\problem{48}
	Разбирал Дима Лапшин.

	У нас для каждого размера входа есть схема, использующая случайные биты.
	Понизим ошибку (\TODO), пусть у нас теперь с вероятностью $\frac{1}{2^{2n}}$ по случайным битам ($y$)
	на конкретном входе $x$ схема ошибается.
	\TODO смотри картинку 1

	\begin{Rem}
		У нас количество $y$ растёт, но пофиг.
		Количество кружчков ($x$-ов, на которых фейлится) "--- константа,
		но доля каждого кружочка уменьшается экспоненциально, получим успех.
	\end{Rem}
	В результате нашли одну подсказку, которая подходит всем.

\problem{43}
	Разбирал семинарист.

	Пусть есть какой-то язык $L \in \MA$.
	Нам сначала Мерлин прислал подсказку, а потом Артур её потестировал.
	Заметим, что тестировать можем сколько угодно раз, понижая ошибку.

	Подсказка Мерлина ограничена полиномом от длины исходного слова (независимо от случайных бит),
	т.е. она длины не более $|y|$.
	Потестируем Артура так, чтобы вероятность ошибки оказалась $\frac{1}{2^{2|y|}}$.
	Нарисуем кружочек со случайными битами.
	В нём "--- много маленьких: какие случайные биты не подходят для конкретной подсказки Мерлина,
	всего $2^{|y|}$ кружочков.
	Размер кружочка "--- $\frac{1}{2^{3|y|}}$.
	Получаем, что суммарно они покроют не более $\frac{1}{2^{|y|}}$, значит, лишь такая
	доля битов имеет хоть какую-то подсказку, которая завалит Артура.
	Успех: с большой вероятностью Артур правильно ответит независимо от Мерлина.

\problem{37}
	\subsubsection{От Оли}
		Разбирала Оля Черникова.

		Рассмотрим вершины дерева, выберем ту, в которой максимум размеров детей минимален.
		Пусть он строго больше двух третей $n$, имеет размер $k$.
		Значит, порежем по ребру к нему и останется часть $\le \sfrac 1 3$ (включая нашу вершину).
		Посмотрели на него: у него один сосед $\le \sfrac 13$, а из оставшихся
		оба размера не больше $k-1$, что успех (еще чуть аккуратнее с $\pm 1$).

		Теперь мы распилили дерево по вершине: два ребёнка и родитель.
		В детях построили неглубокие схемы, а родителя скопировали два раза (и подставили в него ноль и один по очереди).
		Потом скомбинировали эти четыре схемы, получили дерево глубины $4 + \O(\log \sfrac23 n)$.
		Посчитали, получили, что константа из ошки как-то выражается через 4 и $\log \sfrac 23$.

	\subsubsection{От семинариста}
		Алгоритм разрезания: хотим найти вершину $v$ такую, что в её поддереве от $\sfrac 1 3$ до $\sfrac 23$
		вершин (и в родителе, соответственно, столько же), надо аккуратно со знаками и $\pm 1$.
		Берём корень.
		Если подошёл "--- ок (но очень вряд ли, в его поддереве лежат все вершины).
		Если не подошёл "--- идём в более жирного ребёнка, повторить.
		Полезность в том, что мы так можем считать не только число вершин, но и что-то
		полуаддитивное: полуаддитивно, если в вершине \textit{не больше}, чем сумма мер поддеревьев
		(т.е. подойдёт число листьев, но не размер поддерева).
