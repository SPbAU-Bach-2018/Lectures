\chapter{Занятие 15.04.2016 (графы)}

\section{Разбор домашней работы}
	Первые шесть задач могут не соответствовать рассказанному на разборе.

\subsection{Задача 1.1}
	Можно перерисовать и покрасить граф так (отсюда сразу $\chi(G) \le 4$):
	\begin{center}
		\begin{dot2tex}[scale=0.8,options=-tmath]
			graph G {
				node [color=yellow]; 1
				node [color=red]; 6 5
				node [color=green]; 2 7
				node [color=blue]; 3 4
				1 -- {2 -- 3; 4 -- 5}
				{2; 3} -- 6 -- 7 -- {4; 5}
				{ rank=same; 2 3 4 5 }
				{ rank=same; 6 7 }
			}
		\end{dot2tex}
	\end{center}
	Покажем, что $\chi(G) > 3$ от противного: пусть покрасили в три цвета.
	Тогда в каждом треугольнике вершины имеют разные цвета.
	Отсюда сразу следует, что если два треугольника пересекаются по ребру,
	то их третьи вершины покрашены одинаково.
	В частности, тогда бы вершины 1 и 6 были покрашены одинаково (так как треугольники $\{1,2,3\}$
	и $\{2,3,6\}$ пересекаются по ребру) и вершины 1 и 7 были бы покрашены одинаково.
	Противоречие: вершины 6 и 7 должны иметь разные цвета.
	Стало быть, $\chi(G) = 4$.

	В графе, очевидно, есть треугольники.
	Пар треугольников с общим ребром всего две, ни одна из них не достраивается до $K_4$,
	стало быть, $\omega(G)=3$.

	Число независимости "--- хотя бы два (например, $\{1, 6\}$).
	Заметим, что граф можно покрыть трёмя кликами: $\{1\}$, $\{2,3,6\}$, $\{4,5,7\}$,
	значит, $\alpha(G) \le 3$.
	Чтобы было равенство, надо выбрать по одной вершине в каждой клике.
	Значит, точно выбирается вершина 1, тогда нельзя выбирать вершины 2, 3, 4, 5, остаются только
	6 и 7, но их нельзя выбрать одновременно.
	Значит, $\alpha(G)=2$.

\subsection{Задача 1.2}
	Задача была в классной работе в прошлый раз и там же разбиралась, $\chi(G)=5$.
	% \TODO добавить ссылку

\subsection{Задача 1.3}
	Возьмём раскраску $G$ в $\chi(G)$ цветов, пусть в цвет 1 покрашены вершины $a_{1,1}, a_{1,2}, \dots, a_{1,k_1}$,
	в цвет 2 "--- $a_{2,1}, \dots, a_{2,k_2}$ и так далее.
	Тогда дадим жадному алгоритму следующий порядок:
	\[
		a_{1,1}, \dots, a_{1,k_1}, a_{2,1}, \dots, a_{2,k_2}, \dots, a_{\chi(G), 1}, \dots, a_{\chi(G), k_{\chi(G)}}
	\]
	Покажем, что каждая вершина будет покрашена в цвет не больший, чем в исходной раскраске.
	Тогда, очевидно, жадный алгоритм покрасит не более чем в $\chi(G)$ цветов.
	Вместе с тем он не может покрасить менее чем в $\chi(G)$ цветов, значит, покрасит ровно в $\chi(G)$.

	Показывать будем индукцией по префиксам вершин в нашем списке
	(т.е. утверждение индукции "--- каждая вершина из префикса покрашена в цвет не больший,
	чем в исходной раскраске).
	База "--- пустой префикс, всё верно.
	Переход: пусть утверждение верно для вершин с номерами, меньшими $l$ в нашем списке ($l \ge 1$), покажем,
	что оно верно для вершины с номером $l$.
	Пусть вершина $l$ имела цвет $x$ в исходной раскраске.
	Тогда среди уже покрашенных вершин она может иметь только соседей, которые имели цвет
	строго меньше $x$ в исходной раскраске $\Ra$ они имеют цвет строго меньше $x$ в раскраске жадного алгоритма.
	Значит, цвет $x$ точно среди них не встречается, значит, жадный алгоритм покрасит в цвет с номером не больше $x$,
	что и требовалось показать.

\subsection{Задача 1.4}
	Давайте докажем чуть более сильное утверждение: если выбрать произвольное подмножество
	пересечений прямых как вершины графа (а рёбра по-прежнему провести между соседними вершинами
	на одной прямой), то такой граф тоже можно покрасить в три цвета.
	Доказывать будем индукцией по числу выбранных вершин $n$.

	База: $n \ge 3$. Очевидно.
	Переход: пусть имеется $n$ вершин.
	Давайте найдём среди них самую верхнюю (если таких несколько "--- самую левую из них).
	Заметим, что в ней пересекается не более двух прямых (по условию).
	Более того, на каждой прямой в одном из направлении вершин быть не может (так как мы выбирали
	самую верхнюю-левую из всех).
	Значит, степень вершины не более двух.
	Удалим её из графа, останется граф с $n-1$ вершиной, покрасим его по индукционному предположению в три цвета,
	добавим обратно удалённую вершину, выберем для неё цвет, не встречающийся среди двух соседей.
	Доказали переход.

\subsection{Задача 1.5}
	Если в $G$ нечётные циклы отсутствуют, то он двудольный и его можно покрасить в два цвета.

	Если же в $G$ есть хотя бы один нечётный цикл $C$, то давайте на него посмотрим.
	Рассмотрим граф $G - C$, в нём уже нечётных циклов быть не может.
	В самом деле: если в $G - C$ есть нечётный цикл $C'$, то он же был в графе $G$,
	но тогда бы он пересекался с $C$ и в $G-C$ уже бы не было какого-то куска, противоречие.
	Значит, $G-C$ является двудольным графом и его можно покрасить в два цвета.
	А нечётный цикл $C$ можно покрасить в три цвета, значит, граф $G$ можно покрасить
	в $2+3=5$ цветов.

\subsection{Задача 1.6}	
	Выберем произвольную вершину $v$, покажем, что $\deg v \ge k - 1$.
	От противного: пусть $\deg v < k - 1$
	Рассмотрим граф $G-v$.
	Так как $G$ был $k$-критическим, то $G-v$ можно раскрасить в не более чем $k-1$ цвет.
	Заметим, что так как у $v$ не более $k-2$ соседей, то среди $k-1$ цветов графа $G-v$ можно найти тот,
 	в который можно покрасить $v$.
 	Значит, весь $G$ тоже можно покрасить в $k-1$ цвет, противоречие.

\subsection{Задача 1.7}
	\begin{Rem}
		В условии забыли написать, что $G$ "--- критический граф.
	\end{Rem}
	Обозначим $\chi(G)$ за $k$.
	Для левого неравенства воспользуемся задачей 1.6:
	\begin{gather*}
		\left.
			\begin{aligned}
				\delta(G) &\ge k - 1 \\
				\Delta(G) &\ge \delta(G)
			\end{aligned}
		\right\}
			\Ra
			\Delta(G) \ge k - 1
			\iff
			\Delta(G) + 1 \ge k
			\iff
			k \le \Delta(G) + 1
	\end{gather*}

	Для доказательства правого неравенства напишем условие из задачи 1.6 для каждой вершины и просуммируем:
	\begin{gather*}
		\deg v \ge k - 1 \\
		\sum_v \deg v \ge \sum_v (k - 1) \\
		2m \ge n(k - 1) \\
		\frac{2m}{n} \ge k - 1 \\
		k - 1 \le \frac{2m}{n} \\
		k \le \frac{2m}{n} + 1 \\
	\end{gather*}

\subsection{Задача 1.8}
	Так как граф раскрашиваем в $k$ цветов, то в нём есть $k$-критический подграф $G'$.
	Очевидно, что в нём хотя бы $k$ вершин (иначе можно раскрасить в менее чем $k$ цветов).
	По задаче 1.6 в нём каждая вершина имеет степень хотя бы $k-1$.
	Значит, если рассмотреть все эти вершины в исходном графе $G$, то их тоже будет
	хотя бы $k$ и каждая будет иметь степень хотя бы $k-1$.

\subsection{Задача 1.9}
	Возьмём $k$-критический подграф $G'$ графа $G$, пусть он состоит из $t$ вершин
	(очевидно, $t \ge k$).
	У каждой вершины $G'$ степень хотя бы $k-1$, значит, в $G'$ лежит хотя бы $\frac{t(k-1)}{2}$ рёбер.
	Кроме $G'$ в $G$ имеется еще $n-k$ вершин, а весь граф связен.
	Чтобы связать подграф $G'$ с этими $n-k$ вершинами, надо хотя бы $n-k$ рёбер
	(можно смотреть на это как на связывание $n-k+1$ вершины).

	Итого в $G$ имеется хотя бы $\frac{t(k-1)}{2}+n-k$ рёбер.
	Мы также знаем, что $t\ge k$, стало быть:
	\[
		|E(G)| \ge \frac{k(k-1)}{2} + n - k = \binom{k}{2} + n - k
	\]

\section{Разбор классной работы}
\TODO тут и ниже
\subsection{Задача 1}
	Пусть у нас есть две смежные вершины: $x$ и $y$, а их степени "--- $d_x$ и $d_y$.
	Тогда по принципу Дирихле у них есть хотя бы $d_x + d_y - n$ общих соседей,
	т.е. они образуют хотя бы $d_x + d_y - n$ треугольников.

	Просуммируем это неравенство по всем неупорядоченным парам смежных вершин (т.е. по всем рёбрам),
	получим оценку на количество треугольников с фиксированным рёбром:
	\[
		T \ge \sum_{\substack{(x, y)=e \in E}} d_x + d_y - n = \sum_{x \in V} d_x^2 - nm
	\]
	Оцениваем первое слагаемое по неравенству о средних (среднее квадратическое не меньше среднего):
	\[
		\sqrt{\frac{\sum d_x^2}{n}} \ge \frac{\sum d_x}{n} = \frac{2m}{n} \\
		\frac{\sum d_x^2}{n} \ge \frac{4m^2}{n^2} \\
		\sum d_x^2 \ge \frac{4m^2}{n} \\
	\]
	Оценка получается такая:
	\[
		T \ge \frac{4m^2}{n} - nm
	\]

	\[
		\ge \frac{1}{n} \left(\sum d_x \right)^2 - nm =
		\frac{4m}{n} - nm
	\]
	Дальше /3 вылезает, потому что мы посчитали каждый треугольник три раза (упорядоченно)

\subsection{Задача 4}
	Слева мы считаем тройки вершин $(a, b, c)$ (порядок $b$ и $c$ не важен), причём есть рёбра $a \to b$, $a \to c$.
	\TODO
	Пример, когда неправда, когда неравенство нестрогое: $K_{2,l-1}$.

\subsection{Задача 2}
	От противного: пусть обхват графа хотя бы пять.
	Возьмём вершину $x$ степени $d_x$, возьмём всех её соседей.
	Обхват хотя бы три, значит, они все между собой попарно не связны.
	Более того, так как обхват не четыре, ни у каких двух из них нет общих соседей.
	Нарисуем такое двухуровневое дерево, посчитаем число листьев, оно будет равно
	\[ \sum_{(x, y_i) \in E} d_{y_i}-1 \le n - d_x - 1 \] % справа - из комбы
	Просуммируем по всем $x$:
	\begin{gather*}
		\sum_{x \in V} d_x^2 - 2m \le n^2 - 2m - n \\
		\sum_{x \in V} d_x^2 \le n^2 - n = n(n-1) \\
		\sum_{x \in V} d_x^2 \ge \frac{4m^2}{n} \\
		\frac{4m^2}{n} \le n(n-1) \\
		4m^2 \le n^2(n-1) \\
		2m \le n\sqrt{n-1} \\
		m \le \frac12 n\sqrt{n-1} \\
	\end{gather*}

\subsection{Задача 3}
	Подсказка: можно так же оценивать количества вершин слоями.
