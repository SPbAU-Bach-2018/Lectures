\chapter{Занятие 19.02.2016 (комба)}
\section{Классная работа}
\subsection{Задача 1}
	По формуле включений-исключений мы берём все перестановки,
	потом вычитаем те, у которых хотя бы одна неподвижная точка,
	потом добавляем те, у которых хотя бы две неподвижных точки и так далее:
	\[ D_n = n! - \binom{n}{1}(n-1)! + \binom{n}{2}(n-2)! + \dots \]

\subsection{Задача 2}
	\[ D_{n+1} = nD_n + nD_{n-1} \]
	Все беспорядки длины $(n+1)$ у нас разбиваются на два типа
	\begin{enumerate}
		\item
			Элемент $(n+1)$ входит в цикл $(n+1, i)$, таких беспорядков $nD_{n-1}$.
			В одну сторону: выкидываем элементы $(n+1), i$.
			В другую сторону: взяли беспорядок, добавили произвольный $i$ и $(n+1)$,
			поставили их в цикл.
		\item 
			Элемент $(n+1)$ входит в цикл длины не менее трёх.
			Мы должны выбрать, после какого он входит в цикл в беспорядке на $n$ элементах,
			итого $nD_n$.
	\end{enumerate}

\subsection{Задача 3}
	Оценим разность:
	\begin{gather*}
		\left|\underbrace{\frac{n!}{e}}_{n!\cdot e^{-1}} - D_n\right| =
		n!\left|\sum_{k=n+1}^\infty \frac{(-1)^k}{k!}\right| \\
	\end{gather*}
	Замечаем, что ряд под модулем "--- знакопеременный, и модули слагаемых монотонно стремятся к нулю.
	Значит, его сумма не больше, чем первый элемент ряд.
	Таким образом при $n>1$:
	\[
		\left|\frac{n!}{e} - D_n\right| \le n! \cdot \frac{1}{(n+1)!} = \frac{1}{n+1} < \frac 1 2
	\]
	Случай $n=1$ надо разобрать отдельно.

\subsection{Задача 4}
	Есть куча различимых шариков "--- это разряды.
	Есть пять ящичков, соответствующих нечётным числам.
	Надо разложить шарики по ящикам, в два ящика надо положить хотя бы один шарик, в трёх "--- неважно.
	Производящие функции для непустых ящиков есть $e^z-1$,
	для ящиков без ограничений "--- $e^z$.
	Получаем производящую функцию для ответа:
	\[ (e^z-1)^2(e^z)^3 = e^{5z}-2e^{4z}+e^{3z} \]
	И коэффициент для $n$:
	\[ 5^n - 2\cdot4^n + 3^n \]
	Такой же ответ можно получить по формуле включений-исключений: берём все числа, вычитаем те,
	в которых нет либо 1, либо 3, добавляем обратно те, в которых нет ни того, ни другого.

\subsection{Задача 5}
	Различимые шарики "--- это гости.
	Ящики "--- это столы, их три штуки.
	Пишем производящие функции:
	\begin{enumerate}
		\item $\frac{z}{1!} + \frac{z^2}{2!} + \frac{z^3}{3!} + \dots = e^z - 1$
		\item $\frac{z}{1!} + \frac{z^3}{3!} + \frac{z^5}{5!} + \dots = \frac{e^z - e^{-z}}{2}$
		\item $\frac{1}{0!} + \frac{z^2}{2!} + \frac{z^4}{4!} + \dots = \frac{e^z + e^{-z}}{2}$
	\end{enumerate}
	Берём произведение:
	\begin{gather*}
		(e^z-1)\cdot\frac{e^z-e^{-z}}{2}\cdot\frac{e^z-e^{-z}}{2} =
		\frac{(e^z-1)(e^{2z}-e^{-2z})}{4} =
		\frac{e^{3z}-e^{-z}-e^{2z}+e^{-2z}}{4}
	\end{gather*}
	Итого получаем ответ для $n$:
	\[ \frac{3^n-(-1)^n-2^n+(-2)^n}{4} \]

\subsection{Задача 6}
	Давайте запишем производяющую функцию, коэффициенты которой "--- количество способов записать число $n$
	в двоичной системе счисления не более чем $(k+1)$ битами (т.е. степени двойки от 0 до $k$).
	Выглядит она вот так:
	\[ f(z) = (1+z)(1+z^2)(1+z^4)(1+z^8)\dots(1+z^{2^k}) \]
	В самом деле: коэффициент при $z^k$ "--- это мы в точности из каждой скобки мы выбираем одно из слагаемых,
	при этом сумма каких-то степеней двоек получается равной $k$, то есть мы построили биекцию
	между каждым выбором слагаемых в скобках и двоичной записью числа.
	Давайте домножим эту функцию на $(1-z)$:
	\begin{align*}
		(1-z)f(z)
		&= (1-z)(1+z)(1+z^2)(1+z^4)\dots(1+z^{2^k}) = \\
		&= (1-z^2)(1+z^2)(1+z^4)\dots(1+z^{2^k}) = \\
		&= (1-z^4)(1+z^4)\dots(1+z^{2^k}) = \\
		&= \dots = \\
		&= 1-z^{2^{k+1}} \\
	\end{align*}
	Таким образом, исходная функция была равна:
	\[
		f(z) = \frac{1-z^{2^{k+1}}}{1-z} = 1 + z + z^2 + \dots + z^{2^{k+1}-1}
	\]
	То есть все её коэффициенты равны единице, что и требовалось доказать.

\subsection{Задача 7}
	Тут нам нужны обычные производящие функции, а не экспоненциальные, потому что перемешивать
	элементы трёх отрезков между собой нельзя.
	Пишем производящие функции, внутри отрезков будем считать комбинаторно, без производящих функций.
	Каждая производящая функция будет считать число возможных отрезков с $n$ занятиями, потом перемножим.
	\begin{enumerate}
		\item
			\[ f_1=\sum_{n=0}^\infty 2^nz^n = \frac{1}{1-2z}\]
			Как угодно раскидываем $n$ занятий между практиками и лекциями
		\item
			\[ f_2=\sum_{n=1}^\infty 2^{n-1}z^n = \frac{z}{1-2z} \]
			Тут мы пользуемся следующим соотношением (верным при $n \ge 1$), чтобы посчитать количество способов выбрать нечётное число практик:
			\[ \binom{n}{1}+\binom{n}{3}+\binom{n}{5}+\dots = \frac{(1+1)^n-(1-1)^n}{2} = \frac{2^n}{2} = 2^{n-1} \]
		\item
			\[ f_3=\sum_{n=1}^\infty 2^{n-1}z^n = \frac{z}{1-2z} \]
			Тут мы пользуемся аналогичным соотношением (верным при $n \ge 1$):
			\[ \binom{n}{0}+\binom{n}{2}+\binom{n}{4}+\dots = \frac{(1+1)^n+(1-1)^n}{2} = \frac{2^n}{2} = 2^{n-1} \]
	\end{enumerate}
	Теперь перемножаем обычные производящие функции, получаем:
	\[ f_1f_2f_3 = \frac{z^2}{(1-2z)^3} \]
	\TODO доделать ответ и проверить

\section{Домашние задания}
	Выкладываются на сайт, сдаются письменно, желательно по электронной почте.
