\chapter{Занятие 01.04.2016}
\section{Разбор задач}

\subproblem{31}{a}
	Разбирал Егор Суворов.

	От противного.
	Воспользуемся леммой о накачке, получим некоторое число $n$, рассмотрим слово:
	\[ s=\t{a}^{n+2}\t{b}^{n+2}\t{a}^{n+2}\t{b}^{n+2} \]
	Лемма о накачке выделит в нём подстроку $uyv$ длины не более $n$, которую можно раздувать.
	Заметим, что при удалении краёв этой подстроки останутся на месте либо первые $n+3$ символа $s$ ($\t{a}^{n+2}\t{b}$),
	либо последние $n+3$ символа $s$ ($\t{a}\t{b}^{n+2}$).
	А по ним однозначно определяется вид слова и требуемая длина.
	Однако же после удаления $u$ и $v$ длина слова уменьшится, противоречие.

\subproblem{31}{b}
	Разбирал Дима Лапшин.

	От противного.
	Воспользуемся леммой о накачке, получим некоторое число $n$, рассмотрим слово:
	\[ s = \t{a}^n\t{b}^n\t{c}\t{a}^n\t{b}^n \]
	Пусть по лемме о накачке мы нашли какую-то подстроку $uyv$ длины не более $n$,
	которую можно растягивать в две стороны.
	Дальше три случая:
	\begin{itemize}
		\item
			Если $\t{c} \notin uyv$, то у нас уже проблемы: при накачке будет меняться только первое слово, а второе не будет.
		\item
			Если $\t{c} \in y$, то у нас в левое слово будут добавляться символы $\t{b}$, а в правое "--- символы $\t{a}$, они тоже станут не равны.
		\item
			Если $\t{c} \in u \cup v$, то можно вообще удалить $u$ и $v$, по лемме о накачке слово должно остаться в языке.
			Но в нём будет ноль символов $\t{c}$, т.е. $k=1$, противоречие.
	\end{itemize}

	\begin{Rem}
		Чтобы чуть упростить рассуждения, можно рассуждать так:
		возьмём наш язык, пересечём его с регулярным языком $\t{a}^*\t{b}^*\t{c}\t{a}^*\t{b}^*$,
		он всё еще контекстно-свободный (по \hyperref[prob24]{задаче 24}).
		Получаем почти тот же язык, но с ограничением $k=2$.
		И вот уже к нему применим лемму о накачке.
	\end{Rem}

\subproblem{31}{c}
	\TODO
	Разбирала Лиза Третьякова.

	От противного.
	Воспользуемся леммой о накачке, получим некоторое число $n$, рассмотрим слово:
	\[ s = \t{a}^{n^2}\t{b}^{n} \]
	Пусть лемма о накачке разрешает нам раздувать строку, добавляя в некоторых местах
	$i$ букв \t{a} и $j$ букв \t{b}, причём слово должно оставаться в языке и $i+j \le n$.
	\begin{Rem}
		Нам неважно, в каких именно местах будут появляться буквы \t{a} и \t{b} "---
		дальше в решении мы будем смотреть лишь на их количество.
	\end{Rem}
	Давайте раздуем слово один раз, получим $|w|_a=n^2+i$, $|w|_b=n+j$.
	Мы знаем, что оно всё еще лежит в языке, то есть:
	\begin{align*}
		n^2 + i &\vdots n + j \\
		n^2 + i &= k(n + j) \\
		n^2 + i &= kn + kj \\
		n(n-k) &= kj - i \\
		kj - i &\vdots n \\
	\end{align*}

	\TODO описать, почему не буду накачивать отдельными кусками
	\TODO закончить решение

\subproblem{31}{d}
	Разбирал Юра Ребрик.

	От противного.
	Воспользуемся леммой о накачке, получим некоторое число $n$, рассмотрим слово:
	\[ s = \t{a}^n\t{b}^n\t{c}^n \]
	Заметим, что любая его подстрока длины не более $n$ не содержит либо \t{a}, либо \t{b}.
	Значит, если мы начнём накачивать слово, то количество одной буквы не изменится, а какой-то из оставшихся (вошедшей в подстроку) "--- изменится.
	Значит, слово не будет лежать в языке, противоречие.

\subproblem{31}{e}
	Разбирал Никита Подгузов.

	От противного.
	Воспользуемся леммой о накачке, получим некоторое число $n$, рассмотрим слово:
	\[ s = \t{a}^{n^2}\t{b}\t{a}^{n^2}\t{b}\t{a}^{n^2}\t{b} \]
	По лемме о накачке мы разбили его на пять кусков: $xuyvz$.
	Мы знаем, что $|uyv|\le n$, значит, $uyv$ вообще не задевает либо первые $n^2+1$ символ,
	либо последние $n^2+2$ символов, т.е. либо первая группа \t{a}-шек, либо последняя при накачке точно не поменяется.

	Какой-то из кусков $u$ и $v$ непуст.
	Предположим сначала, что $u$ содержит букву \t{b}.
	Тогда он имеет вид $\t{a}^i\t{b}\t{a}^j$ (причём $i+j<n$).
	Давайте накачаем строку, повторив $u$ и $v$ два раза, получим:
	\begin{align*}
		s &= l \underbrace{\t{a}^i\t{b}\t{a}^j}_u r \\
		s' &= l \t{a}^i\t{b}\underbrace{\t{a}^j \t{a}^i\t{b}}_X\t{a}^j r'
	\end{align*}
	Заметим, что часть $s$ до первой буквы \t{b} сохранилась, то есть в начале есть
	группа $\t{a}^{n^2}\t{b}$.
	Однако в середине строки появилась группа группа $X=\t{a}^{j+i}\t{b}$,
	причём $j+i <n \le n^2$, т.е. строка не может лежать в языке, противоречие.

	Предположим, что $u$ не содержит \t{b} (то есть содержит только \t{a}), а вот $v$ "--- содержит.
	Подойдёт то же самое действие: повторяем $u$ и $v$ два раза:
	\begin{align*}
		s &= l \underbrace{\t{a}^i\t{b}\t{a}^j}_v r \\
		s' &= l' \t{a}^i\t{b}\underbrace{\t{a}^j \t{a}^i\t{b}}_X\t{a}^j r
	\end{align*}
	Тут уже часть до первой буквы \t{b} не сохранилась, однако первые группы могли только увеличиться в размере.
	Значит, противоречие с наличием короткой группы $X$ всё еще имеется.

	Теперь у нас $u$ и $v$ "--- это какие-то последовательности \t{a}.
	Соответственно, они содержатся в каких-то существующих группах, т.е. при накачке строки
	мы можем лишь менять размеры каких-то групп $\t{a}^k\t{b}$, но не их количество.

	\begin{Rem}
		Дальше пойдёт разбор случаев.
		У Никиты был такой: лежат ли $u$ и $v$ в одной группе, дальше можно их либо
		добавить в строку еще раз, либо совсем удалить, получим противоречие одним из нескольких способов.
		Егору показалось, что можно чуть проще записать ту же идею, это ниже и представлено.
	\end{Rem}
	Заметим, что какая-то из трёх существующих групп не будет меняться при накачке.
	Три случая:
	\begin{itemize}
		\item
			Не меняется самая правая группа.
			Тогда при накачке размер какой-то из двух левых групп будет увеличиваться, получим противоречие.
		\item
			Не меняется самая левая группа.
			Тогда при удалении $u$ и $v$ размер какой-то из двух правых групп уменьшится, получим противоречие.
		\item
			Не меняется центральная группа.
			Тогда если меняется левая группа, то её можно накачать, увеличить длину, получить противоречие.
			Если же меняется только правая группа, то можно удалить $u$ и $v$, уменьшить длину правой группы, противоречие.
	\end{itemize}

\subproblem{31}{f}
	Разбирал Дима Розплохас.

	От противного, применяем лемму о накачке, получаем число $n$, смотрим на слово:
	\[ s =\underbrace{\t{a}^{0}}_{\epsilon}\t{b} \t{a}^{1}\t{b} \t{a}^{2}\t{b} \dots \t{a}^{n}\t{b} \]
	Пусть какой-то из кусков $u$ и $v$ содержит букву \t{b}.
	Пусть он имеет вид $l\t{b}r$.
	Накачаем $s$ трёмя повторами $u$ и $v$, получаем, что где-то в $s$ будет такая подстрока:
	\[ l\t{b}rl\t{b}rl\t{b}r \]
	Противоречие "--- такое слово в языке не лежит, так как есть две одинаковые подстроки $rl$,
	ограниченные \t{b} с разных сторон.
	\begin{Rem}
		Даже если $\t{b} \in rl$, то это нестрашно "--- будет больше повторяющихся подстрок.
	\end{Rem}

	Теперь случай, когда и $u$, и $v$ букву \t{b} не содержат.
	Удалим их из $s$, получим слово из языка.
	С другой стороны, можно посмотреть на самую левую непустую подстроку из $u$ и $v$:
	при её удалении соответствующая группа строго сократилась и, как следствие, стала равна какой-то
	из более левых групп.
	Противоречие.

\subsection{Задача 32}
	\subsubsection{От Оли (неверное)}
		Разбирала Оля Черникова и завалилась.

		Внимательно смотрим на задачу и пытаемся понять, чем она отличается от леммы о накачке.
		В лемме о накачке было условие $|uv|>0$, а тут "--- $|u|, |v|>0$.
		Давайте покажем, что если верна лемме о накачке, то задача тоже верна.
		Возьмём язык, по лемме о накачке получим $n$, сделаем его не меньше 2 (лемма всё еще будет верна).
		Дальше нам дают некоторое слово, лемма о накачке его разбивает на пять частей $xuyvz$, причём $|uyv| \le n$.
		Если $|u|, |v|>0$, то мы выиграли.
		Если не выиграли, то ровно одно слово пусто.
		Не умаляя общности считаем, что $|v|=0$, то есть все слова $xu^iyz$ лежат в языке.

		Дальше хочется две вещи: чтобы $|u|\ge2$, тогда его можно разбить на две части и сказать,
		что у нас всё получилось.
		Но есть проблема: нам надо это не поможет.
		Даже если $u=u_1u_2$, то у нас слова $xu_1u_2u_1u_2\dots yz$
		принадлежат языку, а вовсе не $xu_1u_1\dots u_1u_2\dots u_2 yz$, как надо в задаче.

	\subsubsection{От Никиты}
		Разбирал Никита Подгузов.

		Начало идеологически очень похоже, но работаем аккуратнее и частично передоказываем лемму о накачке.
		Давайте считать, что у нас грамматика в нормальной форме Хомского.
		Пусть в грамматике $b$ нетерминалов, тогда давайте выберем $n$ равным $2^{2b+1}$.
		Нам дали некоторое слово $s$, построим его дерево разбора.
		Тогда в нём точно будет ветка, состоящая из хотя бы $2b+1$ нетерминала.
		\begin{Rem}
			Этот факт можно доказать от противного по индукции: дерево разбора,
			где все ветки содержат не больше $k$ нетерминалов, не может представлять
			строку длины более $2^k$.
		\end{Rem}
		Значит, в этой ветке хотя бы один нетерминал встречается трижды, обозначим его $A$.
		Спускаясь от $S$ к первому месту мы представим $s$ в виде $l\,A\,r$.
		Спускаясь ко второму месту "--- представим $A$ в виде $u\,A\,v$.
		Если при этом $|u|, |v|>0$, то мы уже выиграли "--- строку можно накачивать ровно этими $u$ и $v$.

		Иначе не умаляя общности можно считать, что $|u|=0$ (а $|v|>0$, так как у нас хоть одна
		строка непустая), т.е. $A \to A\, v$.
		Теперь спускаемся по дереву еще глубже и выводим из $A$ строку $u'\,A\,v'$.
		Опять же, если $|u'|, |v'|>0$, то мы выиграли.
		Если $|u'|>0$, то мы научились выводить из $A$ строку $u'\,A$,
		т.е. можно накачивать язык при помощи $u'$ и $v$.
		Если же $|v'|>0$, то мы знаем, что из $A$ выводятся и $A\,v$, и $A\,v'$,
		тогда можно считать, что после $A$ можно добавлять последовательности вида
		$v^k{v'}^k$ "--- в точности накачивание языка, что и требовалось.

\subsection{Задача 33}
	\TODO
	Разбирала Оля Черникова.

	У нас есть почти лемма о накачке, но <<длина>> слова считается только по помеченным символам в строке.
	Возьмём грамматику в нормальной форме Хомского.
	Возьмём в качестве $P$ число $2^{|N|}$ (тут $N$ "--- множество нетерминалов).
	Нам дадут строку и выделенные позиции, построим для неё дерево разбора (оно не более чем двоичное).
	Посмотрим на выделенные листья, повыделяем их LCA, дерево останется двоичным.
	\TODO Дальше рассуждения как в лемме о накачке, не забыть про условие $|uyv|\le p$.

	\begin{Rem}
		Это называется леммой Огдена (Ogden's lemma).
		Её придумали, чтобы доказать какой-то результат, но её не хватило.
		Потом придумали еще более общую версию, кажется, там еще каким-то символам можно запрещать находиться в разбиении.
	\end{Rem}

\subsection{Задача 34}
	\TODO
	Разбирал Дима Розплохас.

	Напишем очевидную грамматику.
	\begin{align*}
		S &\to A\,\t{c}^{*} \mid \t{a}^{*}\,C \\
		A &\to \epsilon \mid \t{a}\,A\,\t{b} \\
		C &\to \epsilon \mid \t{b}\,C\,\t{c} \\
	\end{align*}
	Она однозначна для всех строк, кроме строк $\t{a}^n\t{b}^n\t{c}^n$.

	Давайте покажем, что однозначной грамматики для языка нет.
	Воспользуемся доказательством леммы Огдена: повторим его аккуратно без нормальной формы Хомского.
	Возьмём из неё число $p$.
	Рассмотрим такое слово:
	\[ a^{(2p)!}b^{(2p)!}c^{p!} \]
	Пометим все буквы $\t{b}$
	\TODO

	Новое решение от 14.04:
	\[ a^{p!}b^{2\cdot p!}c^{2\cdot p!} \]
	Хотим сказать, Что в дереве разбора обязательно будет нетерминал, в котором можно надувать ашки (лемма 9, см. ниже).
	Надувать их можно длиной $\le p$, а $p!$ на это делится, что хорошо.
	Тогда мы додуем это слово до $a^{2p!} b^{2p!} c^{2p!}$.
	Потом аналогично с a$^{2p!}b^{2p!}c^{p!}$, додуем его до того же самого.
	Упс, получили, что если грамматика однозначна, то эти два дерева совпадают$\Ra$
	в $a^k b^k c^k$ можно дуть и то, и другое, вылезли из языка, противоречие.

	Лемма 9: мы пометим все ашки, а дальше повторим доказательство леммы Огдена.
	Саму лемму Огдена мы использовать не можем, потому что нам важен не ответ леммы, а структура ответа внутри грамматики и конкретная грамматика,
	которая у нас не в форме Хомского. Надо доказать лемму еще раз без формы Хомского.
