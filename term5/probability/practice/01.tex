%\def\repbinom#1#2{\ensuremath{\left(\kern-.3em\left(\genfrac{}{}{0pt}{}{#1}{#2}\right)\kern-.3em\right)}}

\author{Bugakova Nadya}
\section{06.09}
\begin{itemize}
	\item Выбор чисел из {1, 2, 3, \dots, n}.
	\begin{center}
	\begin{tabular}{cc|c}
	& Упорядоченный выбор & Неупорядоченный выбор \\
	& & \\
	С возвращением & $n^k$ & $\repbinom{n}{k} = \binom{n + k - 1}{k}$ \\
	& & \\
	\hline
	& & \\
	Без возвращения & $\frac{n!}{(n - k)!}$ & $\binom{n}{k}$ \\ 
	\end{tabular}
	\end{center}
	\item \[ \boxed{ P(A) = \frac{|A|}{|\Omega|} } \] - формула для вероятности события A.
	
	8 ладей стоят на доске 8х8. Какова вероятность того, что расстановка будет мирной?
	
	\[P[\text{Мирная расстановка}] = \frac{8!}{\binom{64}{8}}\]
	\item  С какой вероятностью ни одна ладья не стоит на главной диагонали, при условии, что расстановка мирная(как и в предыдущем случае, доска 8x8, а ладей 8)?
	
	\[P(\text{нет ладей на главной}) = \frac{\text{\# беспорядков}}{8!} \approx \frac{1}{e} \], т.к.:
	
	\[P(\text{неподвижная точка}) = P(\bigcup\limits_{k = 1}^n A_k) = n \frac{1}{n} - \frac{(n - 2)!}{n!}\binom{n}{2} + \frac{(n - 3)!}{n!}\binom{n}{3} - \dots = \]
	\[ = 1 - \frac{1}{2!} + \frac{1}{3!} + \dots + (-1)^{n + 1}\frac{1}{n!} \xrightarrow{n \rightarrow \infty} 1 - \frac{1}{e}\], где $A_k$ - k неподвижных точек. В нашем случае n = 8, поэтому только примерно. Здесь используется хорошо известная нам формула включений-исключений по количеству неподвижных точек.
	\item Есть доска n $\times$ m. Точка A - левый нижний угол, точка B - правый верхний. Интересует количество путей из A в B. Очевидно, чтобы посчитать их количество, надо посчитать количество вариантов выбрать из n + m шагов, которые надо будет совершить, n шагов наверх. Или, что то же самое - n шагов вправо. Т.о. ответ: $\binom{m + n}{n} = \binom{m + n}{m}$. 
	\item Задача о баллотировке. (рисунок) 2 кандидата(A и B) соревнуются. Всего было a + b голосов - a за A, b за B. Голоса подсчитываются последовательно, по порядку, однако порядок случайный. С какой вероятностью во время всего подсчёта A лидировал?
	
	Принцип отражения: (картинка)
	
	\# плохих путей из C в D = \# всех путей из C' в D, где C' - отражение C относительно какой-то горизонтальной линии. Плохим путь называется, если он линии касается.
	
	Тогда:
	\[P(\text{А лидировал}) = 1 - \frac{2\binom{a + b - 1}{a}}{\binom{a + b}{a}} = \frac{a - b}{a + b}\]
	Здесь мы считаем количество плохих путей. Путь плохой, если первый ход сделан вниз(то есть первый голос за B). Все такие пути плохие и их столько же, сколько путей из (1, -1) в (a + b, a - b). Иначе используем принцип отражения (отражаем начальный кусок пути до первого касания линии), и получим ещё одно такое же число. Всего путей из точки (0, 0) в (a + b, a - b) - $\binom{a + b}{a}$, так и получаем.
	
	Для нестрогого варианта задачи нужно опустить линию. Ответ тогда получится $\frac{a - b + 1}{a + 1}$.
	
	\item Формула Лапласа.
	
	У нас n шариков: n1 белых + n2 чёрных. Из них мы случайным образом выбрали k.
	
	\[P(\text{Среди выбранных шариков ровно k1 белый}) = \frac{\binom{n1}{k1}\binom{n2}{k - k1}}{\binom{n}{k}}\]
	
	Теперь пусть у нас обычная колода в 52 карты. Мы выбрали из них 5.
	
	\[P(\text{есть туз}) = P_1 + P_2 + P_3 + P_4 = \frac{\binom{4}{1}\binom{48}{4}}{\binom{52}{5}} + \frac{\binom{4}{2}\binom{48}{3}}{\binom{52}{5}} + \dots\], $P_i$ - среди наших карт ровно i тузов.
	
	\item Обобщение формулы Лапласа.
	
	Есть n предметов, мы хотим разбить их на $d$ упорядоченных кучек, в i-ой $k_i$ элементов. Тогда количество способов это сделать равно:
	\[\binom{n}{k_1}\binom{n - k_1}{k_2}\binom{n - k_1 - k_2}{k_3} \dots \binom{k_d}{k_d} = \frac{n!}{k_1!k_2!\dots k_d!} = \binom{n}{k_1, k_2, \dots, k_d}\]
	
	Игра в преферанс, у нас колода из 32 карт. В преферансе колода раскладывается на 4 кучки - 32 = 10 + 10 + 10 + 2. Найти вероятность того, то в первой кучке 2 пики и 4 буби, во второй - 3 пики и 2 буби, в третьей - 3 пики и 1 буби и в четвёртой - 0 пик и 1 буби.
	
	\[P(\text{пики 2 - 3 - 3 - 0, буби 4 - 2 - 1 - 1}) = \frac{\binom{8}{2, 3, 3} \binom{8}{4, 2, 1, 1}\binom{16}{4, 5, 6, 1}}{\binom{32}{10, 10, 10, 2}} \]
	
	\item Все знают формулу $\sum\limits_{k = 0}^{n} \binom{n}{k} = 2^n$. Попробуем доказать комбинаторно формулу $\sum\limits_{k = 0}^n \binom{n}{k}^2 = \sum\limits_{k = 0}^n \binom{n}{k}\binom{n}{n - k} = \binom{2n}{n}$.
	
	Это можно сделать двумя способами:
	\begin{itemize}
		\item Есть 2n предметов. Они условно поделены на 2 кучки по n. И наше количество - выбрать произвольные n предметов. Мы перебираем количество предметов, которые мы возьмём из первой условной кучки, а затем остальные добираем из второй. Ясно, что кучки только условные, поэтому, это то же самое, что просто выбрать n предметов из 2n.
		\item  У нас есть квадрат n $\times$ n. Мы хотим дойти из нижнего левого угла до правого верхнего. Любой путь проходит через какую-нибудь клетку диагонали. Мы перебираем эту клетку и считаем все пути от нижнего левого угла до неё, домножая затем на все пути от неё до правого верхнего угла. Квадрат симметричен, так что и там, и там получим $\binom{n}{k}$.
		
		(картинка).
	\end{itemize}
	\item Есть полный набор доминошек. Мы выбрали 2 случайные. Какова вероятность того, что их можно приложить друг у другу по правилам домино?
	
	Доминошка - пара чисел: m|k; m, k = 0 \dots 6. Каждая доминошка в наборе ровно одна.
	
	\[P = \frac{7\cdot6 \text{ (одна из них - дупль)} + 21\cdot 10/2 \text{ (Так как доминошки можно менять местами)}}{\binom{28}{2}}\] 
	
	Сначала предположили, что одна из них - дупль. Тогда три цифры в цепочке, которую мы сложили одинаковы, и для последней есть всего 6 вариантов(так как 2 дупля быть уже не может).
	
	Потом, что обе - не дупли. тогда первая доминошка - одна из 21 не дупля. Повёрнута каждая может быть двумя разными сторонами. И для оставшегося неизвестного числа другой доминошки только 5 вариантов - чтобы был не дупель и не такая же, как первая. Затем ещё делим на 2, так как доминошки на самом деле у нас неупорядочены.
	
	\item Обобщение задачи про ладей.
	
	k ладей на $m \times n$. 
	\[P(\text{стоят мирно} = \binom{n}{k} \binom{m}{k} \frac{k!}{\binom{nm}{k}}\] - выбрали k строк и столбцов, где будут стоять ладьи, а дальше аналогично частному случаю.
	
	\item Игра на вылет. Есть $2^n$ участников. Они пронумерованы, в первом раунде 1 играет со 2, 3 с 4, 5 с 6 и т.д. Проигравгие вылетают. И затем выигрывший из первой пары играет с выигрывшим из второй, выигрывший из третьей с выигрывшим из четвёртой и т.д. 
	
	Все участники строго ранжированы. Более сильный всегда побеждает более слабого. Нумерация игроков случайна. Найти вероятность того, что 2 по силе будет играть в финале.
	
	\[P(\text{2 в финале}) = \frac{(2^{n - 1})^2}{\binom{2^n}{2}} = \frac{2^{n - 1}}{2^n - 1}\]
	
	Исходы - пары мест для 1 и второго. Чтобы 2 прошёл в финал, он не должен сыграть с первым до конца, то есть первый должен быть среди первых $2^{n - 1}$ нумеров, а второй - среди последних $2^{n - 1}$ или наоборот. Пары мест мы считаем неупорядоченно, так что всё равно.
	\item Теперь та же игра на вылет, но по силе все равны. И в каждом матче у каждого шансы победить - 1/2. В турнире участвуют две сестры. Найти вероятность того, что сёстры сыграют друг с другом(здесь берётся вероятность и по жеребьёвки и по играм).
	
	\[P = P_1 + P_2 + \dots + P_n\] - в каком туре сёстры сыграют.
	
	И снова, исходы - неупорядоченные пары мест. Чтобы в первом туре сёстры сыграли друг с другом, они должны быть рядом, то есть $2^{n - 1}$ хороших вариантов.
	\[P_1 = \frac{1}{2^n - 1} \]
	
	\[P_2 = \frac{2^{n - 2} \cdot 2 \cdot 2}{\binom{2^n}{2}}\frac{1}{2}\frac{1}{2} = \frac{P_1}{2} \]
	
	Таким образом, 
	
	\[P = P_1(1 + \frac{1}{2} + \frac{1}{4} + \dots + \frac{1}{2^{n - 1}}) = \frac{1}{2^{n - 1}}\]
\end{itemize}

