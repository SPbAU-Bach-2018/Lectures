\begin{exmp}
	$f(t) = (\cos t, \sin t)$, $b = 2\pi$, $a = 0$:
	\begin{gather*}
		f(b) - f(a) = \vec 0 \\
		\| f(b) - f(a) \| = 0 \\
		f'(t) = (-\sin t, \cos t) \\
		\| f'(t) \| = \sqrt{\sin^2 t + \cos^2 t} = 1
	\end{gather*}
	Очевидно, равенство здесь недостижимо.
\end{exmp}

\section{Частные производные}

Если есть функия от многих переменных, мы можем взять сечение её графика плоскостью, и рассматривать производную оставшейся функции.

\cautoimg{10_partial_derivative}
\begin{center}
\small\url{http://moodle.capilanou.ca/mod/book/view.php?id=328667\&chapterid=1398}
\end{center}

\begin{Def}
	Пусть есть функция $f\colon D \ra \R$, точка $a \in \Int D$ и вектор направления $\vec h\colon \|h\| = 1$.
	Рассмотрим функцию
	\[ F(t) = f(a + th), t \in \R \]
	Тогда производной $f$ по направлению $h$ в точке $a$ называют
	\[ \partd{f}{h}(a) = F'(0) \]
\end{Def}

\begin{Rem}
	\[ F'(0) = \lim_{t \ra 0} \frac{F(t) - F(0)}t = \lim_{t \ra 0} \frac{f(a + th) - f(a)}t \]
	Очень похоже на определение производной функции одной переменной.
\end{Rem}

\begin{assertion}
	$f\colon D \ra \R$, $a \in \Int D$, $f$ дифференцируема в $a$, $h$ "--- ненулевой вектор.
	\[ \partd{f}{h}(a) = \d_a f(h) \]
\end{assertion}
\begin{proof}
	\begin{gather*}
		\partd{f}{h}(a) = F'(0) \\
		\d_a f\colon t \mapsto Tt \\
		\d_0 F = \underbrace{\d_a f}_{t \mapsto Tt} \circ \underbrace{\d_0 (a + th)}_{t \mapsto ht} = (t \mapsto Tht) \\
		\d_0 F = (t \mapsto F'(0) \cdot t) \\
		F'(0) = Th = (t \mapsto Tt)(h) = \d_a f(h)
	\end{gather*}
\end{proof}

\begin{theorem}[Экстремальное свойство градиента]
	$f\colon D \ra \R$, $a \in \Int D$, $f$ дифференцируема в $a$, $h$ "--- напралвение, $\nabla f(a) \ne 0$.
	Тогда
	\[ \left|\partd{f}{h}(a)\right| \le \|\nabla f(a) \| \]
	и равенство достигается только в случае $h \parallel \nabla f(a)$.
\end{theorem}
%% ... %%
\begin{proof}
	\begin{gather*}
		\left|\partd{f}{h}(a)\right| = |\left< \nabla f(a), h\right>| \le \|\nabla f(a)\| \|h\| = \|\nabla f(a) \|
	\end{gather*}
	В неревенстве Коши"---Буняковского равенство было как раз в случае параллельности векторов $\nabla f(a)$ и $h$.
\end{proof}

То есть градиент указывает, где производная максимальна.
Физический смысл градиента такой: пусть есть поверхность. Положим на неё шарик. Он покатится в направлении, противоположном градиенту.

\begin{Def}
	Частная производная "--- производная по направлению базисного вектора
	\[ e_k = (0, \dots, \underbrace{1}_{k}, \dots, 0) \]
	Записывается:
	\[ \partd{f}{e_k} (a) \]
\end{Def}
\begin{Rem}
	\begin{gather*}
		\partd{f}{e_k} (a) = \lim_{t \ra 0} \frac{f(a_1, \dots, a_k + t, \dots, a_n) - f(a_1, \dots, a_k, \dots, a_n)}t = \\
		= \lim_{t \ra 0} \frac{g(a_k + t) - g(a_k)}t = \frac{\d g}{\d x} (a_k) \quad g(x) \lrh f(a_1, \dots, x, \dots, a_n)
	\end{gather*}
	Таким образом, частная производная "--- производная всей функции по одной координате.
\end{Rem}
Обозначения:
\[
	\begin{matrix}
		\partd{f}{x_k} & D_{x_k} f & f'_{x_k}
	\end{matrix}
\]

\begin{exmp}
	$f(x, y) = x^y$:
	\begin{gather*}
		\partd{f}{x} (x, y) = y \cdot x^{y - 1} \\
		\partd{f}{y} (x, y) = \ln x \cdot x^y \\
	\end{gather*}
\end{exmp}

\begin{conseq}
	$f\colon D \subset R^n \ra \R$, $a \in \Int D$, $f$ дифференцируема в $a$.
	\[ \partd{f}{e_k} (a) = \left<\nabla f(a), e_k\right> = (\nabla f(a))_k \]
	Таким образом,
	\[ \nabla f(a) = \left( \partd{f}{e_1} (a), \dots, \partd{f}{e_n} (a) \right) \]
\end{conseq}

\begin{conseq}
	$f\colon \R^n \ra \R^m$, $a \in \Int D$, $f$ дифференцируема в $a$.
	Тогда матрица Якоби (матрица дифференциала)
	\[\begin{pmatrix}
		\partd{f_1}{e_1}(a) & \partd{f_1}{e_2}(a)
			&\cdots& \partd{f_1}{e_n}(a) \\
		\partd{f_2}{e_1}(a) & \partd{f_2}{e_2}(a)
			&\cdots& \partd{f_2}{e_n}(a) \\
		\vdots & \vdots & \ddots & \vdots \\
		\partd{f_m}{e_1}(a) & \partd{f_m}{e_2}(a)
			&\cdots& \partd{f_m}{e_n}(a)
	\end{pmatrix}\]
\end{conseq}
\begin{proof}
	\begin{gather*}
		f(a + h) = f(a) + \d_a f(h) + o(h) \\
		f_i(a + h) = f_i(a) + (\d_a f(h))_i + o(h) = f_i(a) + \d_a f_i(h) + o(h) = f_i(a) + \left<\nabla f_i(a), h\right> + o(h)
	\end{gather*}
	Отсюда видим, что $i$-я строка матрицы есть вектор частных производных:
	\begin{gather*}
		\begin{pmatrix}
			\nabla f_1(a) \\
			\nabla f_2(a) \\
			\vdots \\
			\nabla f_m(a)
		\end{pmatrix}
	\end{gather*}
\end{proof}

\begin{conseq}
	Формула для дифференциала композиции:
	$f\colon D \subset R^n \ra R^m$, $g\colon E \subset R^m \ra R^l$, $f(D) \subset E$, $a \in \Int D$, $f(a) \in \Int E$,
	$f$ дифференцируема в $a$, $g$ "--- в $f(a)$.
	Тогда
	\[ \d_a(g \circ f) = \d_{f(a)} g \circ \d_a f \]
	то есть матрица $\d_a (g \circ f)$ есть
	\[ \begin{pmatrix}
		\partd{g_1}{e_1}(a) & \partd{g_1}{e_2}(a)
			&\cdots& \partd{g_1}{e_n}(a) \\
		\partd{g_2}{e_1}(a) & \partd{g_2}{e_2}(a)
			&\cdots& \partd{g_2}{e_n}(a) \\
		\vdots & \vdots & \ddots & \vdots \\
		\partd{g_l}{e_1}(a) & \partd{g_l}{e_2}(a)
			&\cdots& \partd{g_l}{e_m}(a) \\
	\end{pmatrix}\begin{pmatrix}
		\partd{f_1}{e_1}(a) & \partd{f_1}{e_2}(a)
			&\cdots& \partd{f_1}{e_n}(a) \\
		\partd{f_2}{e_1}(a) & \partd{f_2}{e_2}(a)
			&\cdots& \partd{f_2}{e_n}(a) \\
		\vdots & \vdots & \ddots & \vdots \\
		\partd{f_m}{e_1}(a) & \partd{f_m}{e_2}(a)
			&\cdots& \partd{f_m}{e_n}(a) \\
	\end{pmatrix}\]
	и
	\[ \partd{(g \circ f)_i}{e_k} = \sum_{j = 1}^m \partd{g_i}{e_j} (f(a)) \partd{f_j}{e_k} (a) \]
\end{conseq}

\begin{Rem}
	Наличие частных производных ничего не говорит о дифференцируемости:
	\begin{gather*}
		f(x, y) = \begin{cases} 0 & xy = 0 \\ 1 & xy \ne 0 \end{cases} \\
		f'_x(0, 0) = 0 \quad f'_y(0, 0) = 0
	\end{gather*}
	Сама функция даже не непрерывна!

	Даже если потребовать про все направления, ситуацию это не исправит. Рассмотрим функцию, равную единице только на дуге

	\begin{center}
	\input{10_arc_exmp}
	\end{center}

	Там все производные по направлению равны нулю, так как суженная на направление функция равна нулю везде, кроме одно фиксированной точки, отделённой от нуля.
	То есть сужение в некоторой окрестности нуля равно нулю, соответственно, производная в нуле тоже ноль.
\end{Rem}

\begin{theorem}
	$f\colon D \subset \R^n \ra \R$, $a \in \Int D$, все частные производные в окрестности $a$ существуют и непрерывны.
	Тогда $f$ дифференцируема в $a$.
\end{theorem}
