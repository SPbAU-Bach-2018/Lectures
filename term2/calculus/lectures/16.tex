\begin{proof}
	Рассмотрим $F\colon D \to \R^{n+m}\colon F(x, y) = (f(x, y), y)$ и проверим условие об обратимой функции.
	Мы знаем, что $f$, то есть первые коорлинаты $F$, дифференцируема:
	\[ f(a+h, b+k) - f(a, b) = A(h, k) + r(h, k) \quad r(h, k) = o(\|(h, k)\|) \]
	а на последних координатах $F$ она совсем дифференцируема:
	\[ b + k - b = k \]
	Тогда
	\begin{gather*}
		F(a+h, b+k) - F(a, b) = B(h+k) + (r(h, k), 0_m) \\
		B(h, k) = (A(h, k), k)
	\end{gather*}
	Даже видно, что $F$ непрерывно дифференцируема.

	Проверим, что $B$ обратимо. Проверим, что однородное уравнение $B(h, k) = (0, 0)$ имеет только нулевое решение:
	\begin{gather*}
		(A(h, k), k) = B(h, k) = (0, 0) \Ra k = 0 \\
		A(h, 0) = 0 \Ra h = 0
	\end{gather*}
	Тогда по теореме об обратной функции существют окрестность $U$ точки $(a, b)$,
	окрестность $V$ точки $F(a, b) = (0, b)$ и $G\colon V \to U$, обратная к $F$.
	Поймём, как устроенна $G$:
	\begin{gather*}
		(f(x, y), y) = F(x, y) = (z, w) \\
		G(z, w) = (x, y) = (\phi(z, w), w)
	\end{gather*}
	$\phi$ "--- некая непрерывно дифференцируемая функция.
	\[ g(w) := \phi(0, w) \]
	У нас есть $V$ вокруг $(0, b)$, нам нужно выбрать из неё срез только по последним координатам (первые всегда 0).
	Обозначим её за $W$ "--- область определения $g$.

	Проверим свойтсва $g$:
	\begin{gather*}
		F(a, b) = (0, b) \quad g(b) = \phi(0, b) = a \\
		f(g(y), y) = f(\phi(0, y), y) = (f \circ G)(0, y)
			= \biggl(\underbrace{(F \circ G)(0, y)}_{(0, y)}\biggr)_{\text{только первые координаты}} = 0
	\end{gather*}
\end{proof}

\begin{exmp}
	Есть уравнение $x^5 + ax + b = 0$ и знаем какой-то корень, $(a, b) \in D$.
	Хотим найти самое большое значение корня.
	Тогда по нашей теореме можно увидеть, что функция корня от $(a, b)$ дифференцируема,
	причём производная задана неявно, саму функцию выписвать не нужно (тем более в данном случая общей формулы нет).
\end{exmp}

\section{Уловные экстремумы}

\begin{Def}
	$f\colon D \subset \R^{n+m} \to \R$, $\Phi\colon D \to \R^m$, $a \in D$, $\Phi(a) = 0_m$.
	$a$ называется строгим локальном максимумом при $\Phi = 0$, если
	\[ \exists U_a\colon \forall z \in \dot U\colon \Phi = 0, f(z) > f(a) \]
	Аналогичные определения минимума и нестрогих максимума и минимума.
\end{Def}

\begin{theorem}[Метод множителей Лагранжа]
	$f\colon D \subset \R^{n+m} \to \R$ "--- непрерывно дифференцируема,
	$\Phi\colon D \to \R^m$ "--- непрерывно дифференцируема,
	$a \in D\colon \Phi(a) = 0_m$ "--- точка условного экстремума.
	Тогда
	\[ \nabla f, \nabla \Phi_1, \nabla \Phi_2, \dots, \nabla \Phi_m \]
	линейно зависимы.
\end{theorem}
\begin{Def}
	Если $\nabla \Phi_i$ линейно \textbf{не}зависимы, то
	\[ \nabla f = \lambda_1 \nabla \Phi_1 + \lambda_2 \nabla \Phi_2 + \dots + \lambda_m \nabla \Phi_m \]
	$\lambda_i$ называются множителями Лагранжа.
\end{Def}
\begin{Rem}
	Выше написана система на $n + m$ координат $x$, $m$ множителей Лагранжа,
	$n + m$ уравнений из линейной комбинации и ещё $m$ из условия $\Phi(x) = 0$.
	Итого $n + 2m$ переменных и $n + 2m$ уравнений.
	К сожалению, это всё совсем не обяхательно линейно.
\end{Rem}
\begin{Rem}
	$z = (x, y)$. Выпишем матрицу Якоби:
	\[
		\begin{pmatrix}
			\partd{\Phi_1}{z_1} & \partd{\Phi_1}{z_2} & \cdots & \partd{\Phi_1}{z_{n+m}} \\
			\partd{\Phi_2}{z_1} & \partd{\Phi_2}{z_2} & \cdots & \partd{\Phi_2}{z_{n+m}} \\
			\vdots & \vdots & \ddots & \vdots \\
			\partd{\Phi_m}{z_1} & \partd{\Phi_m}{z_2} & \cdots & \partd{\Phi_m}{z_{n+m}} \\
		\end{pmatrix}
	\]
	Необходимые градиенты $\nabla \Phi_i$ "--- строки этой матрицы.
	Заметим, что строк меньше столбцов.
	Тогда условие независимости $\nabla \Phi_i$ равносильно тому, что ранг матрицы Якоби максимально возможный.
\end{Rem}
\begin{proof}
	Доказывать имеет смысл в случае независимости $\nabla \Phi_i$.

	Пусть не равный 0 определитель "--- определитель c последними $m$ столбцами.
	$a = (b, c)$, $b \in \R^n$, $c \in \R^m$, $\tong \d_a \Phi = m$, $A \lrh \d_a \Phi$,
	\[
		\det \begin{pmatrix}
			\partd{\Phi_1}{y_1} & \partd{\Phi_1}{y_2} & \cdots & \partd{\Phi_1}{y_m} \\
			\partd{\Phi_2}{y_1} & \partd{\Phi_2}{y_2} & \cdots & \partd{\Phi_2}{z_m} \\
			\vdots & \vdots & \ddots & \vdots \\
			\partd{\Phi_m}{y_1} & \partd{\Phi_m}{y_2} & \cdots & \partd{\Phi_m}{z_m} \\
		\end{pmatrix} \ne 0
	\]
	Проверим условие теоремы об обратной функции:
	\[ A(0_n, h) = 0_m \Ra h = 0_m \]
	Тогда из теоремы о неявной функции знаем, что существует $W$ "--- окрестность $b$ и
	$g\colon W \to \R^m$, что $\Phi(x, g(x)) = 0$ и $g(b) = c$.
	Если $a$ "--- условный локальный минимум, то существует окрестность $W$, что
	\[ \forall x \in W, f(b, g(b)) = f(a) \le f(x, g(x)) \]
	Таким образом $b$ "--- локальный минимум функции $H(x) = f(x, g(x))$, $b \in \Int W$.
	Значит
	\begin{gather*}
		\nabla H = 0 \\
		\partd{H}{x_k}(b) = \partd{f}{x_k}(a) + \sum_{i=1}^{m} \partd{f}{y_i}(a) \partd{g_i}{x_k}(b) \\
		\Phi(x, g(x)) = 0 \\
		0 = \partd{\Phi_j}{x_k}(a) + \sum_{i=1}^{m} \partd{\Phi_j}{y_i}(a) \partd{g_i}{x_k}(b)
	\end{gather*}

	Анонс: домножим последнее равенство на $\lambda_j$ и сложим их для разных $j$ так,
	чтобы всё ненужное "--- $g_i$ "--- сократилось. Это система уравнений, которая разрешима, потому что её определитель написан наверху и не ноль.
\end{proof}
