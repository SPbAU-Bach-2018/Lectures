\setauthor{Саша Малышева}

\section{Паросочетания}

Что уже есть на двудольном графе:

$O(E V^{\frac{1}{2}})$ - Хопкофт-Карп

$O(VE)$ - Кун

$O(E \log{V})$ - Регулярный двудольный граф

Произвольный граф:

$O(v^3), O^*(VE)$ - сжатие соцветий

$O(E V^{\frac{1}{2}})$ - Вазирани

$O(V^3)$ - Матрица Татта

\begin{theorem}{Теорема Дилворта}
    max Антицепь = min покрытию
\end{theorem}
\begin{lemma}{}
Есть ацикличнвый орентированого графа

(а) - либо транзитивно замкнутый

(b) - либо пути непересекаются

Будем работать в (а)

(a) $=>$ (b):

\cimg{12_8.jpg}{0.5}

\end{lemma}

\begin{description}
\item[1] 

Любой покрытие путями больше антицепи, так как на любое звено антицепи нужен путь.

\item[2] 
Разложим каждую вершину на две: начало и конец всех ребер. Таким образом из  max matching можем востановить min path cover


\cimg{12_9.jpg}{0.5}

Таким образом path = n - |Matching|. Значит, если $matching -> max$. то $path -> min$

Теперь Найдем антицепь такого же размера как Mathing

Антицепь = $V\{Cover Set\}$


\cimg{12_10.jpg}{0.5}

|Cover Set| = |Matching|

Антицепь $>=$ n - |Cover Set|  ($>=$ - так как вершины раздвоены, и могли выкинуть вершинуначального графа 2 раза)

Итак для любого path cover $>=$ антицепи, и мы нашли антицепь $>=$ path Cover. Значит они равны.
\end{description}

\section{Раскраски}


\begin{itemize}

\item[1] 
Двудольный граф: красим ребра так, чтобы у вершины все ребра были разного цвета.

 Тогда:

Colors $>=$ max Deg Так 
\item[1'] 
Если граф регулярный (двудольный), то по лемме Холла существеут совершенное паросочетание.

Выберем одно паросочетание, в нем ребра не имеют общих вершин, покрасим их в один цвет. Таким образом k-регулярный граф $->$ k-цветов. За $O(k Mathing)$
\end{itemize}


Решение основных задач.
\begin{itemize}
\item[1] 
Добавим лишнии ребра так, чтобы сделать D-регулярный граф, где D = max Deg.
\item[2] 
Добавим вершины так, чтобы количество вершин в левой и правой долях совпало.

$|V_1| = |V_2|$
\item[3]
Не D-регулярный значит существует u,v: $u \in V_1, v \in V_2, deg u < D, deg v < D$ - тогда соеденим их, при этом кратные ребра ничего не портят.
\end{itemize}

Быстрая покраска: $O(K Matching) - > log{k} Matching$
\begin{Rem}
T $>=$ Matching, так что $ log{k} Matching$ - это быстро
\end{Rem}

\begin{itemize}
\item[1] 
Если k делиться на 2:

Выделим Эйлеров цикл, и разделим задачу на две:

четные и нечетные ребра цикла.
\item[2] 
k - не делиться на 2
Выделим Matching. За $O(Mathing + E)$

$k -> k-1$.
\end{itemize}

Время работы как у быстрого возведения в степень - $T(k) = T(k/2) + O(Mathing + E)$
 
\section{Количество совершенных паросочетаний}

Введем понятие Перманент: A=$\sum_{\upsigma} \prod a_{i, \upsigma_{i}}$, где А - матрица  смежности.

Тогда совершенное паросочетание - перестановка если $\prod a_{i, {\upsigma_{i}}} = 1$.

Итак совершенное паросочетание = perm A

(perm A) mod 2 = (det A) mod 2, так как -1 = 1 по модулю 2.
\begin{Rem}
det можно посчитать за $O(n^3)$
\end{Rem}

\section{Возвращаемся к покраскам}
Хотим покрасить все вершины так, чтобы две одинакового цвета не были соединины ребром.

D=max deg. В D+1 цвет умеем красить.

Эвристика: удаляем degmin, красим, возвращаем и красим min цвет.

\begin{theorem}{Теорема Брукса}
Если граф не является циклом нечетной длины  и не полный - то его можно покрасить в D цветов, где D = max deg.
(Красим вершины)
\end{theorem}

\begin{theorem}{Теорема Визина}
Любой граф можно покрасить в D или D+1 цвет, но это NP-полная задача.
(Красим ребра)
\end{theorem}

\begin{theorem}{о 4 красках} 
Любой планарный граф можно раскрасить в 4 цвета.
\end{theorem}

\section{Покраска планарного графа}

Пусть уже есть укладка графа. Значит существет вершина, со степенью $\le 5$.

Красим вершины.

Можем покрасить в 6 цветов: выбираем вершину, со степенью $\le 5$, "удаляем" вершину, красим все что осталось, возвращаем вершину и красим.
\begin{theorem}{Можно покрасить в 5 цветов}
\cimg{12_11.jpg}{0.5}
\end{theorem}
\begin{proof}
Пусть у вершины все пять соседей разного цвета. Рассмотрим вершины 1 и 3: мы не можем поменять цвет вершины 1 на 3 только в том случае, если вершины 1 и 3 соеденины цепочкой $1-3-1-\cdots-1-3$. Пусть соедины, тогда рассмотрим вершины 2-4, они не могут быть соедины, так как граф планарный! Значит можем поменять цвет 2 на 4, и покрасить среднюю вершину в 2.

Существует алгоритм покраски в 4 цвета за $O(v^2)$
\end{proof}

\section{Stble Marriage}


\cimg{12_12.jpg}{0.5}
$\forall M -> list[y]$ - упорядоченный список Y

$\forall Y -> list[m]$ - упорядоченный список M

При этом, остаться без пары - хуже всего.


\cimg{12_13.jpg}{0.5}

Нестабильностью назывется ситуация если приоритет $m_2$ > $m_1$ в списке $y_1$, и при этом приоритет $y_2$ > $y_1$ в списке $m_1$

\begin{Rem}
Stable$\nRightarrow$ Max
\end{Rem}

Алгоритм 1:

Находим не стабильность - исправляем. Может длиться бесконечно.

Алгоритм 2:(Мальчики прдлагают - девочки отказываются)

$\forall$ мальчик предлагает первой девочке в списке.
$\forall$ девочка получив предложение говорит "может быть"(если пока лучший из тех, кто предложил) или "нет"(если уже предложил кто-то лучше). 

Пока у всех мальчиков список не будет из 1 элемента.

\begin{Rem}
Алгоритм корректен $=>$ существует Stable Marriage.
\end{Rem}

\begin{theorem}{Алгоритм корректен}

\cautoimg{12_13.jpg}{0.5}

Как могло получиться, что $y_2$ с $m_1$, хотя хочет больше быть с $m_2$. Значит $m_2$ ей не предлогал, или раньше предложил $y_1$, но он больше хочеь быть с $y_2$. Противоречие.
\end{theorem}