\section{Жорданова форма оператора с единственным собственным числом}
% \setauthor{Егор Суворов} - внизу, иначе плохо работает
\begin{theorem} 
\[ V = \bigoplus_{i=1}^n \ker (f - \lambda_i id)^{a_i} \]
Сузим оператор $f$:
\[ f\biggr|_{U_{a_i}(\lambda_i)} \]

\setauthor{Егор Суворов}
В такой ситуации $\lambda$ "--- единственное собственное число суженного оператора $f$.
\end{theorem}

\begin{proof}
	Возьмём некоторое собственное число $\gamma \neq \lambda$
	и посмотрим на оператор $$f - \gamma id = f - \lambda id + (\lambda - \gamma) id$$.
	Покажем, что он обратим (тогда ядро тривиально, тогда $\gamma$ не может быть собственным числом).

	Обратимость не зависит от домножения на ненулевой скаляр.
	Домножим оператор на $\frac{1}{\lambda - \gamma}$:
	\[
	(f - \gamma id) \cdot \frac{1}{\lambda - \gamma}
	=
	\frac{f - \lambda id + (\lambda - \gamma) id}{\lambda - \gamma}
	=
	\frac{f - \lambda id}{\lambda - \gamma} + id
	=
	id - \underbrace{\frac{f - \lambda id}{\gamma - \lambda}}_{g}
	\]
	Т.к. $(f-\lambda id)^{a_i} = 0$ (так как мы живём в соответствующем корневом пространстве), то $g^{a_i} = 0$, то есть $g$ "--- нильпотентный.
	А тождественное минус нильпотентный всегда обратимо, можно явно предъявить:
	\[
	(id - g)(id + g + \dots + g^{a-1}) = id - g^a = id
	\]
\end{proof}

Пусть $V$ "--- векторное пространство и есть подпространство $U \subset V$.
\begin{Def}
	Набор векторов $v_1, \dots, v_k$ называется относительно линейно независимым относительно пространства $U$,
	если следующее равенство выполняется только при $\alpha_i = 0$:
	\begin{gather*}
	\alpha_1 v_1 + \alpha_2 v_2 + \dots + \alpha_k v_k + u = 0 \\
	\alpha_i \in K, u \in U
	\end{gather*}
\end{Def}
\begin{Rem}
	Обычная линейная независимость "--- это относительная относительно подпространства из нуля.
\end{Rem}
\begin{Def}
	Относительное семейство образующих, если любой $v \in V$ можно представить в виде
	\[ \alpha_1 v_1 + \alpha_2 v_2 + \dots + \alpha_k v_k + u = v\]
\end{Def}
\begin{Def}
	Относительный базис "--- если относительно линейно независимо и заодно является относительным семейством образующих
	(всё относительно одного фиксированного $U$).
\end{Def}
\begin{Rem}
	Такая конструкция уже возникала: когда мы брали базис $U$ ($u_i$) и дополняли его до базиса $V$ ($v_i$), мы дополняли его именно относительным базисом,
	то есть эти вот $v_i$ "--- относительный базис $V$ относительно $U$.
	Так что почти ничего нового.
\end{Rem}

Рассмотрим цепочку корневых пространств:
\[ {0} \subset U_1(\lambda) \subset U_2(\lambda) \subset \dots \subset U_a(\lambda) = V \]
(на $U_a$ закончили, так как $f-\lambda id$ занулилось).

Теперь найдём место стабилизации, то есть
такое наибольшее $m$, что $U_{m-1}(\lambda) \subsetneq U_m(\lambda)$.
То есть у нас есть корневые вектора высоты $m$, но больше высоты "--- уже нет.
В частности, отсюда следует, что $U_m(\lambda) = V$.

Найдём относительный базис $U_m(\lambda)$ относительно $U_{m-1}(\lambda)$: $v_1^{(m)}, \dots, v_j^{(m)}$.
\begin{lemma}
	Пусть $u_1, \dots, u_s \in U_r(\lambda)$ и относительно линейно независимы относительно $U_{r-1}(\lambda)$.
	Тогда на эти вектора можно подействовать оператором $f-\lambda id$ и получим:
	\[ (f-\lambda id)u_1, \dots, (f-\lambda id)u_s \in U_{r-1}(\lambda)\]
	Также они относительно линейно независимы относительно $U_{r-2}(\lambda)$.
\end{lemma}
\begin{proof}
	\begin{itemize}
	\item
		Чтобы показать, что они лежат в $(r-1)$-м корневом пространстве, надо применить оператор $(f-\lambda id)$ $(r-1)$ раз:
		\[ (f - \lambda id)^{r-1} ((f-\lambda id) u_i) = (f - \lambda id)^r u_i = 0 \]
		Так как $u_i$ лежало в $r$-м корневом пространстве, то последний переход верен.
	\item
		От противного: предположим линейную зависимость.
		Имеем:
		\[ \alpha_1(f-\lambda id) u_1 + \dots + \alpha_s (f-\lambda id) u_s + \underbrace{w}_{\in U_{r-2}(\lambda)} = 0\]
		Подействуем на это дело $(r-2)$ степенью оператора, тогда $w$ занулится:
		\begin{gather*}
			\alpha_1(f-\lambda id)^{r-1} u_1 + \dots + \alpha_s (f-\lambda id)^{r-1} u_s + 0 = 0 \\
			(f-\lambda id)^{r-1}\underbrace{(\alpha_1 u_1 + \dots + \alpha_s u_s )}_{\widetilde w} = 0 \\
			\widetilde w \in \ker (f - \lambda id)^{r-1} = U_{r-1}(\lambda)
		\end{gather*}
		% TODO
		Так как $u_i$ относительно линейно независимы относительно $U_{r - 1}(\lambda)$, то $\alpha_i=0$,
		что и требовалось доказать.
	\end{itemize}
\end{proof}

А теперь алгоритм действий построения башни векторов:
\begin{itemize}
\item
	Взяли относительный базис $V=U_m(\lambda)$ относительно $U_{m-1}(\lambda)$ из векторов
	$v_1^{(m)}, v_2^{(m)}, \dots, v_{j_m}^{(m)}$.
\item
	Применили оператор $f - \lambda id$, спустили эти вектора на уровень ниже, они остались линейно независимыми.
	Но, возможно, они перестали быть базисом, иногда надо дополнить, получим
	$v_1^{(m-1)}, v_2^{(m-1)}, \dots, v_{j_{m-1}}^{(m-1)}$
	(очевидно, что $j_m \le j_{m-1}$).
\item
	Продолжили спускаться до уровня 1.
	В конце получили $v_1^{(1)}, v_2^{(1)}, \dots, v_{j_{2}}^{(1)}, v_{j_{2}+1}^{(1)}, \dots, v_{j_{1}}^{(1)}$.
	(то, что после $j_2$-го элемента "--- дополнили до базиса $U_1(\lambda)$)
\end{itemize}
% картинка с доски
Посмотрим на эту схему.
Каждая строчка из $v_i^{(k)}$ дополняет базис $(k-1)$-го корневого пространства до базис $k$-го
корневого пространства (не относительного).
Если взять все вектора из строчек с $k$-й и вниз, получим базис (не относительный) $U_k(\lambda)$.
Таким образом, если взять вообще все вектора, то это будет базис пространства $V$.

Теперь давайте прочитаем табличку не по строкам, а по столбцам: сначала первый столбец сверху вниз, потом второй, и так далее.
Посмотрим на пространства, порождённые столбцами.
Пространство $V$ является прямой суммой этих пространств (они не пересекаются, потому что порождены непересекающимися подмножествами базиса $V$).
Возьмём какое-нибудь пространство с базисом-столбцом $v_i^{(r)}, v_i^{(r-1)}, \dots, v_i^{(1)}$ (с высоты $r$ появляется столбец и растёт вниз).
Хотим выписать для него матрицу (так как матрица всего $f$ будет состоять из таких блоков, потому что $f$ "--- прямая сумма):
Знаем, что для любого $2 \le s \le r$:
\begin{gather*}
	(f - \lambda id) v_i^{(s)} = v_i^{(s-1)} \\
	f v_i^{(s)} - \lambda v_i^{(s)} = v_i^{(s-1)} \\
	f v_i^{(s)} = \lambda v_i^{(s)} + v_i^{(s-1)} 
\end{gather*}
А для $s=1$ имеем $f v_i^{(1)} = \lambda v_i{(1)}$ (потому что собственный вектор).
То есть матрица преобразования $f$ имеет вид (это мы смотрим, куда $f$ переводит каждый вектор из базиса):
\[
\begin{vmatrix}
            & v_i^{(1)} & v_i^{(2)} & v_i^{(3)} & \dots  & v_i^{(r-1)} & v_i^{(r)} \\
v_i^{(1)}   & \lambda   & 1         & 0         & \dots  & 0           & 0         \\
v_i^{(2)}   & 0         & \lambda   & 1         & \dots  & 0           & 0         \\
v_i^{(2)}   & 0         & 0         & \lambda   & \dots  & 0           & 0         \\
\vdots      & \vdots    & \vdots    & \vdots    & \ddots & \vdots      & \vdots    \\
v_i^{(r-1)} & 0         & 0         & 0         & \dots  & \lambda     & 1         \\
v_i^{(r)}   & 0         & 0         & 0         & \dots  & 0           & \lambda   \\
\end{vmatrix}
\]
Это в точности Жорданова клетка.
То есть матрица для $f$ есть несколько Жордановых клеток "--- Жорданова форма.
\begin{itemize}
\item Параметр $m$ отвечает максимальному размеру клетки.
\item Количество клеток есть в точности геометрическая кратность собственного числа $\lambda$ (число векторов на последнем уровне).
\item
	Количество клеток размера $k$ и выше "--- число векторов на $k$-м снизу уровне нашей диаграммы.
	Перефразируя: число векторов в относительном базисе $U_k(\lambda)$ относительно $U_{k-1}(\lambda)$,
	то есть $\dim U_k(\lambda) - \dim U_{k-1}(\lambda)$.
\item
	Количество клеток размера в точности $k$:
	\[
	(\dim U_k(\lambda) - \dim U_{k-1}(\lambda)) - (\dim U_{k+1}(\lambda) - \dim U_{k}(\lambda))
	=
	2\dim U_k(\lambda) - \dim U_{k-1}(\lambda) - U_{k+1}(\lambda)
	\]
\end{itemize}
\begin{conseq}
	Мы выразили количество клеток размера в точности $k$ через размерности корневых пространств,
	которые от базиса не зависят.
	Значит, количество клеток однозначно определяется оператором.
\end{conseq}
\begin{conseq}
	Так как количество клеток неотрицательно, можно написать:
	\[ 2\dim U_k(\lambda) \ge \dim U_{k-1}(\lambda) + \dim(U_{k+1}(\lambda)) \]
	То есть последовательность размерностей корневых пространств вогнута.
\end{conseq}
\begin{lemma}{}
Пусть A матрица в Жордановой форме. $\lambda$ "--- собственное число. Алгебраическая кратность 
$\lambda$ = суммарному размеру всех клеток, отвечающих данному собственному числу. 
\end{lemma}
\begin{proof}
$\chi_f(t)$. Кратность $\lambda$ как кратность корня $\chi_f(t)$.

$\chi_f(t)$ не зависит от выбора базиса. 

Характеристический многочлен матрицы в Жордановой форме: $\prod_{\lambda_i}(\lambda_i - t)^{a_i}$.

$a_i$ "--- количество $\lambda_i$ на диагонали Жордановой формы. То есть суммарный размер
всех клеток, отвечающих данном собственному числу.
\end{proof}